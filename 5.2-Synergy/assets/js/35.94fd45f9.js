(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{570:function(t,e,s){"use strict";s.r(e);var a=s(42),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"host-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#host-configuration"}},[t._v("#")]),t._v(" Host configuration")]),t._v(" "),s("p",[t._v("This section outlines the steps to configure the automation environment\nand utilizes the automation environment to create the server profile for\nall Synergy nodes and install SLES 15 SP2 operating system on each of\nthem.")]),t._v(" "),s("h2",{attrs:{id:"preparing-the-execution-environment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#preparing-the-execution-environment"}},[t._v("#")]),t._v(" Preparing the execution environment")]),t._v(" "),s("p",[t._v("This section provides a detailed overview and steps to configure the\ncomponents deployed for this solution.")]),t._v(" "),s("h2",{attrs:{id:"installer-machine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installer-machine"}},[t._v("#")]),t._v(" Installer machine")]),t._v(" "),s("p",[t._v("This document assumes that a server running Centos 7 with the following\nconfiguration exists within the deployment environment and is accessible\nto the installation user to be used in an installer machine.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v('At least 500 GB of free disk space (especially in the "/"\npartition), 4 CPU cores and 8GB RAM.')])]),t._v(" "),s("li",[s("p",[t._v("One (1) network interface with static IP address configured on same\nnetwork as the management plane of the bare-metal servers and has\naccess to internet.")])])]),t._v(" "),s("p",[t._v("In this solution, a virtual machine is used to act as an installer\nmachine and the same host is utilized as an Ansible Engine host.")]),t._v(" "),s("h3",{attrs:{id:"setup-the-prerequisites"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setup-the-prerequisites"}},[t._v("#")]),t._v(" Setup the prerequisites")]),t._v(" "),s("p",[t._v("Login to the installer VM and perform the following steps:")]),t._v(" "),s("ol",[s("li",[t._v("Use the following commands to install and enable Python 3.6.x.")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" centos-release-scl\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" rh-python36\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" scl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" rh-python36 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("Use the following commands to create and activate a Python3 virtual\nenvironment for deploying this solution.")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" python3 -m venv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("virtual_environment_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("virtual_environment_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/bin/activate\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("Use the following command to install Ansible 2.9.")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" python3 -m pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ansible")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.9")]),t._v(".0\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[s("p",[t._v("Disable SELinux")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Edit the /etc/selinux/config file and set the SELINUX to\ndisabled")])]),t._v(" "),s("li",[s("p",[t._v("Reboot the server")])]),t._v(" "),s("li",[s("p",[t._v("Verify the SELinux status by running the following command:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" sestatus\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("Execute the following commands in the Ansible Engine to download the\nrepositories.")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" --p /opt/hpe/solutions/hpecp/\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /opt/hpe/solutions/hpecp/\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/HewlettPackard/hpe-solutions-hpecp.git\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://github.com/HewlettPackard/oneview-ansible.git"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" oneview-ansible\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --r requirements.txt\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ANSIBLE_LIBRARY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/opt/hpe/solutions/hpecp/oneview-ansible/library\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ANSIBLE_MODULE_UTILS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/opt/hpe/solutions/hpecp/oneview-ansible/library/module_utils\n\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("ul",[s("li",[s("p",[t._v('The value for the constant "$BASE_DIR" referred to in this\ndeployment guide is\n/opt/hpe/solutions/hpecp/hpe-solutions-hpecp/Synergy/scripts/')])]),t._v(" "),s("li",[s("p",[t._v("This solution utilizes the Service Pack for ProLiant (SPP)/firmware\nbundle ISO image to enable an unattended update of firmware on the\nservers. Hence, ensure this image is available on the installer\nmachine. Solution utilizes the ISO image of SLES 15 SP 2 to enable\nan unattended installation of SLES on the servers. Hence, ensure\nthis image is also available on the installer machine.")])])])]),t._v(" "),s("h3",{attrs:{id:"ansible-inventory-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ansible-inventory-file"}},[t._v("#")]),t._v(" Ansible inventory file")]),t._v(" "),s("p",[t._v("The files that are cloned from the GitHub site include a sample\ninventory file. The installation user should review this file (located\non the installer VM at $BASE_DIR/infrastructure/hosts and\n$BASE_DIR/prepare_hpecp_hosts/hosts*) and ensure that the information\nwithin the file accurately reflects the information in their\nenvironment.")]),t._v(" "),s("p",[t._v("Use an editor such as vi or nano to edit the inventory file.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BASE_DIR")]),t._v("/infrastructure/hosts\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BASE_DIR")]),t._v("/prepare_hpecp_hosts/hosts\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("p",[t._v("The values provided in the variable files, inventory files, figures, and\ntables in this document are intended to be used for reference purpose.\nIt is expected that the installation user updates them to suit the local\nenvironment.")]),t._v(" "),s("p",[t._v("By default, the forks parameter in Ansible is limited to 5. Execute the\nfollowing command to update the Ansible configuration to increase the\nvalue of number of hosts that are getting configured using this\nplaybook.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ANSIBLE_FORKS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("number_of_hosts_present_in_the_ansible_inventory_file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])]),t._v(" "),s("h3",{attrs:{id:"ansible-vault"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ansible-vault"}},[t._v("#")]),t._v(" Ansible vault")]),t._v(" "),s("p",[t._v("A preconfigured Ansible vault file ("),s("em",[t._v("secret.yml")]),t._v(") is provided as a part\nof this solution, which consists of sensitive information to support the\nhost and virtual machine deployment.")]),t._v(" "),s("p",[t._v("Run the following commands on the installer VM to edit the vault to\nmatch the installation environment.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ansible-vault edit "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BASE_DIR")]),t._v("/infrastructure/secret.yml\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("p",[t._v("The default password for the Ansible vault file is "),s("strong",[t._v("changeme")]),t._v(".")])])])}),[],!1,null,null,null);e.default=n.exports}}]);