(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{387:function(s,a,t){s.exports=t.p+"assets/img/AF-IC1.cc382a51.png"},388:function(s,a,t){s.exports=t.p+"assets/img/AF-IC2.d3960982.png"},389:function(s,a,t){s.exports=t.p+"assets/img/AF-IC3.fa323610.png"},390:function(s,a,t){s.exports=t.p+"assets/img/AF-IC4.64a0095e.png"},391:function(s,a,t){s.exports=t.p+"assets/img/AF-IC5.07ce6aa0.png"},392:function(s,a,t){s.exports=t.p+"assets/img/AF-IC6.0e04d56b.png"},393:function(s,a,t){s.exports=t.p+"assets/img/AF-IC7.5efe7fec.png"},394:function(s,a,t){s.exports=t.p+"assets/img/AF-IC8.02701b93.png"},551:function(s,a,t){"use strict";t.r(a);var e=t(42),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"importing-plain-k8s-cluster-into-hpecp-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#importing-plain-k8s-cluster-into-hpecp-cluster"}},[s._v("#")]),s._v(" Importing plain K8s cluster into HPECP cluster")]),s._v(" "),e("h3",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[s._v("#")]),s._v(" Introduction")]),s._v(" "),e("p",[s._v("This section covers about deploying a plain kubernetes cluster on open SUSE linux OS and then importing into HPECP cluster, so we can manage all clusters from single pane of glass")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("NOTE")]),s._v(" "),e("p",[s._v("The imported cluster can be made up of physical servers or it can be a virtual machine setup.")])]),s._v(" "),e("h3",{attrs:{id:"hardware-requirements"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hardware-requirements"}},[s._v("#")]),s._v(" Hardware Requirements")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("PLATFORM")]),s._v(" "),e("th",[s._v("VMWare")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("O.S")]),s._v(" "),e("td",[s._v("Open Suse Leap 15.2")])]),s._v(" "),e("tr",[e("td",[s._v("MEMORY")]),s._v(" "),e("td",[s._v("8 GB")])]),s._v(" "),e("tr",[e("td",[s._v("CPU")]),s._v(" "),e("td",[s._v("4 vCpu's")])]),s._v(" "),e("tr",[e("td",[s._v("HDD")]),s._v(" "),e("td",[s._v("150 GB")])]),s._v(" "),e("tr",[e("td",[s._v("NETWORK")]),s._v(" "),e("td",[s._v("Twentynet")])]),s._v(" "),e("tr",[e("td",[s._v("VM's")]),s._v(" "),e("td",[s._v("3 (1 Master & 2 Worker)")])])])]),s._v(" "),e("h3",{attrs:{id:"installation-process-for-creating-kubernetes-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation-process-for-creating-kubernetes-cluster"}},[s._v("#")]),s._v(" Installation Process for Creating Kubernetes Cluster.")]),s._v(" "),e("p",[s._v("Follow below steps on all nodes.")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Assign IP Address, Hostnames & make entries in DNS")])]),s._v(" "),e("li",[e("p",[s._v("Get the latest updates of your server")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" ref "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" dup --y\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Install Docker")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" docker-18.09.6_ce\n")])])])]),s._v(" "),e("li",[e("p",[s._v('Add the following lines after "{" to /etc/docker/daemon.json file')]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/docker/daemon.json\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exec-opts"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"native.cgroupdriver=systemd"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-driver"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2"')]),s._v(",\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Restart & Enable Docker service")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" systemctl restart docker "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n")])])])])]),s._v(" "),e("p",[s._v("Follow below steps on master nodes.")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Add firewall rules to the ports")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6443")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2379")]),s._v("-2380/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10250")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10251")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10252")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10255")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --reload\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Run modprobe command")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("> modprobe overlay\n\n> modprobe br_netfilter\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Edit /etc/sysctl.conf & apply")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysctl.conf\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("net.ipv4.ip_forward "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nnet.ipv4.conf.all.forwarding "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nnet.bridge.bridge-nf-call-iptables "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sysctl --p\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Add K8s repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" addrepo --type yum --gpgcheck-strict --refresh https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64google-k8s\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Add gpg key for repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg%20%20"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])])]),s._v(" "),e("p",[s._v("If the command throws an error, execute 2 or more times until it get succeed")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://packages.cloud.google.com/yum/doc/yum-key.gpg"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),e("ol",{attrs:{start:"6"}},[e("li",[e("p",[s._v("Refresh the repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" refresh google-k8s\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Install kubeadm, kubelet, kubectl")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" -y kubelet-1.18.4 kubeadm-1.18.4 kubectl-1.18.4\n")])])]),e("p",[s._v("(When prompted press 2, 3, y)")])]),s._v(" "),e("li",[e("p",[s._v("Disable swap")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("swapon")]),s._v(" --s\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" swapoff --a\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Enable kubelet service")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" kubelet\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Initialize kubeadm & copy the token, so it will be useful to run in worker nodes for joining the cluster")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubeadm init\n")])])]),e("p",[s._v('(If got an error, then execute "zypper install conntrack-tools" again\nrun kubeadm init)')]),s._v(" "),e("p",[e("img",{attrs:{src:t(387),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("Allow root user to access kubectl commands")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Deploy the pod network (weavenet)")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl apply -f "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("https://cloud.weave.works/k8s/net?k8s-version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl version "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr")]),s._v(" -d"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),e("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("https://cloud.weave.works/k8s/net?k8s-version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl%20version%20"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("%20base64%20"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("%20tr%20-d%20"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),e("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Check the status of master node & pods")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl get nodes\n")])])]),e("p",[e("img",{attrs:{src:t(388),alt:""}})])])]),s._v(" "),e("p",[s._v("Follow below steps on worker nodes:")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Add firewall rules on the ports")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6783")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10250")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10255")]),s._v("/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --permanent --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("-32767/tcp\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" firewall-cmd --reload\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Run modprobe command")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" modprobe overlay\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" modprobe br_netfilter\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Edit /etc/sysctl.conf & apply")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysctl.conf\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("net.ipv4.ip_forward "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nnet.ipv4.conf.all.forwarding "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nnet.bridge.bridge-nf-call-iptables "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" sysctl --p\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Add K8s repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" addrepo --type yum --gpgcheck-strict --refresh https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64google-k8s\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Add gpg key for repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg%20%20"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),e("p",[s._v("If the command throws an error, execute 2 or more times until it get\nsucceed")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("https://packages.cloud.google.com/yum/doc/yum-key.gpg"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Refresh the repository")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" refresh google-k8s\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Install kubeadm, kubelet, kubectl")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("zypper")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" -y kubelet-1.18.4 kubeadm-1.18.4 kubectl-1.18.4\n")])])]),e("p",[s._v("(When prompted press 2, 3, y)")])]),s._v(" "),e("li",[e("p",[s._v("Disable swap")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("swapon")]),s._v(" --s\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" swapoff --a\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Enable kubelet service")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" kubelet\n")])])])]),s._v(" "),e("li",[e("p",[s._v("Paste the token copied from master node")]),s._v(" "),e("p",[e("img",{attrs:{src:t(389),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("Now execute following command on master node to see if worker nodes\njoined the cluster")]),s._v(" "),e("p",[e("img",{attrs:{src:t(390),alt:""}})]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl get nodes\n")])])])])]),s._v(" "),e("h3",{attrs:{id:"installation-process-for-importing-kubernetes-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation-process-for-importing-kubernetes-cluster"}},[s._v("#")]),s._v(" Installation Process for Importing Kubernetes Cluster")]),s._v(" "),e("p",[s._v("Follow below steps on Master nodes:")]),s._v(" "),e("p",[s._v("1.Execute the following command to get Kubernetes cluster URL")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl cluster-info\n")])])]),e("p",[e("img",{attrs:{src:t(391),alt:""}})]),s._v(" "),e("p",[s._v("2.Create service account, clusterrolebinding, ca-certs, tokens")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl create serviceaccount NAME_OF_YOUR_CHOICE\n")])])]),e("p",[s._v("Ex: - kubectl create serviceaccount hpe")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl create clusterrolebinding add-on-cluster-admin --clusterrole"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cluster-admin --serviceaccount"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default:NAME_OF_YOUR_CHOICE\n")])])]),e("p",[s._v("Ex: - kubectl create clusterrolebinding add-on-cluster-admin\n--clusterrole=cluster-admin --serviceaccount=default:hpe")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SA_TOKEN")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("kubectl get serviceaccount/ NAME_OF_YOUR_CHOICE -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(".secrets"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(".name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n")])])]),e("p",[s._v("Ex: - SA_TOKEN="),e("code",[s._v("kubectl get serviceaccount/hpe -o jsonpath={.secrets[0].name}")])]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl get secret "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SA_TOKEN")]),s._v(" -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(".data.token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" token.base64\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" kubectl get secret "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SA_TOKEN")]),s._v(" -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.data.ca\\.crt'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ca.crt.base64\n")])])]),e("p",[s._v('3.Open hpecp controller UI, on the left side navigate to kubernetes &\nclick on clusters, then click on "import cluster"')]),s._v(" "),e("p",[e("img",{attrs:{src:t(392),alt:""}})]),s._v(" "),e("p",[s._v("4.Fill the following details")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v('A) Name the cluster\n\nB) Enter description\n\nC) Type is "generic"\n\nD) Pod Dns name is "cluster.local"\n\nE) Server URL --\x3e you will have to execute Step 1 to get these details\n\nF) CA CERTIFICATE & BEARER TOKEN --\x3e you will have to execute Step 2 and copy the keys from ca.crt.base64 & token.base64\n')])])]),e("p",[e("img",{attrs:{src:t(393),alt:""}})]),s._v(" "),e("p",[s._v("5.Click on next and click submit, after sometime you should see the\ncluster status is ready")]),s._v(" "),e("p",[e("img",{attrs:{src:t(394),alt:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);