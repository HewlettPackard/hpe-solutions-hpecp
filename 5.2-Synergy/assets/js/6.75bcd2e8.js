(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{395:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO1.1862bcc7.png"},396:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO2.1469216c.png"},397:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO3.1af59d2c.png"},398:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO4.c7c252e0.png"},399:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO5.d4fbce27.png"},400:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO6.e57118f7.png"},401:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO7.452d41f2.png"},402:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO8.35aa0507.png"},403:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO9.263bf074.png"},404:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO10.cd6e9a04.png"},405:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO11.54e43cc3.png"},406:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO12.ba179ce4.png"},407:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO13.c69759d6.png"},408:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO14.04ed5561.png"},409:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO15.65ba733c.png"},410:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO16.af803e2c.png"},411:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO17.de65a78f.png"},412:function(t,e,s){t.exports=s.p+"assets/img/AF-ISTIO18.fe112c49.png"},552:function(t,e,s){"use strict";s.r(e);var a=s(42),o=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"istio-with-kiali-dashboard-deployment-on-hpecp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#istio-with-kiali-dashboard-deployment-on-hpecp"}},[t._v("#")]),t._v(" Istio with Kiali dashboard deployment on HPECP")]),t._v(" "),a("h3",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),a("p",[t._v("Istio is a service mesh technology that helps in service-to-service communications. It provides an easy way to create a network of deployed services with load balancing, service-to-service authentication, monitoring and many more without requiring any changes in service code. Istio deploys a special sidecar proxy that intercepts all network communication between microservices, using Istio's control plane functionality. Kiali works with Istio to visualize the service mesh topology. Kiali is a management console for Istio, and as such, Istio is a requirement. It provides and controls the service mesh")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Pre-requisites")]),t._v(" "),a("ul",[a("li",[t._v("Access to HPECP WEBGUI")])])]),t._v(" "),a("h3",{attrs:{id:"flow-diagram"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flow-diagram"}},[t._v("#")]),t._v(" Flow Diagram")]),t._v(" "),a("p",[a("img",{attrs:{src:s(395),alt:""}})]),t._v(" "),a("h3",{attrs:{id:"deployment-process"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deployment-process"}},[t._v("#")]),t._v(" Deployment Process")]),t._v(" "),a("h4",{attrs:{id:"create-hpecp-istio-cluster"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-hpecp-istio-cluster"}},[t._v("#")]),t._v(" Create HPECP ISTIO cluster")]),t._v(" "),a("p",[t._v("Add kubernetes hosts by following below steps.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Login into HPECP platform by providing required username and password.")])]),t._v(" "),a("li",[a("p",[t._v("Click on Kubernetes tab in the left panel and navigate to the Kubernetes Hosts Installation page.")])]),t._v(" "),a("li",[a("p",[t._v("Add hosts by providing IP address, credentials and set istio-ingressgateway tag to true.")])])]),t._v(" "),a("p",[a("img",{attrs:{src:s(396),alt:""}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("Refer to "),a("RouterLink",{attrs:{to:"/solution-deployment/manually-install-and-configure-hpecp.html#add-kubernetes-hosts"}},[t._v("Add Kubernet Hosts")]),t._v(" section to get more details on adding kubernetes hosts.")],1)]),t._v(" "),a("ul",[a("li",[t._v('Node status will become "Ready" once node installed successfully. Make sure that tag is set to istio-ingressgateway as shown in below snapshot.')])]),t._v(" "),a("p",[a("img",{attrs:{src:s(397),alt:""}})]),t._v(" "),a("h4",{attrs:{id:"create-the-hpecp-istio-cluster"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-hpecp-istio-cluster"}},[t._v("#")]),t._v(" Create the HPECP ISTIO cluster")]),t._v(" "),a("p",[t._v("Follow below steps to create ISTIO cluster.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Navigate to Cluster creation page under Kubernetes menu and click on Create Kubernetes Cluster.")])]),t._v(" "),a("li",[a("p",[t._v("For host configuration, select the required master and worker nodes and click on Next.")])]),t._v(" "),a("li",[a("p",[t._v("Cross verify cluster configuration details and Click on Next.")])]),t._v(" "),a("li",[a("p",[t._v("Provide authentication details if required.")])]),t._v(" "),a("li",[a("p",[t._v("Select Istio application under "),a("strong",[t._v("Application Configuration")]),t._v(". And click on Next.")])])]),t._v(" "),a("p",[a("img",{attrs:{src:s(398),alt:""}})]),t._v(" "),a("ul",[a("li",[t._v('Next page shows up the summary and click on submit create the cluster. Cluster status shows "ready" once the cluster created successfully.')])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("Refer to "),a("RouterLink",{attrs:{to:"/solution-deployment/Manually-Install-and-configure-HPECP.html#create-a-kubernetes-cluster"}},[t._v("Cluster Creation")]),t._v(" section to get more information on cluster creation process.")],1)]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Once the tenant is created, Necessary Istio ingress gateway and Kiali application access points will be created. Follow below steps to create tenant.")])]),t._v(" "),a("li",[a("p",[t._v("Select tenant option under Kubernetes menu and click on create tenant.")])]),t._v(" "),a("li",[a("p",[t._v('As shown in the below snapshot, select Istio cluster in "K8s Cluster" drop down menu and check the option "Enable Istio Service Mesh".')])])]),t._v(" "),a("p",[a("img",{attrs:{src:s(399),alt:""}})]),t._v(" "),a("ul",[a("li",[t._v('Once the tenant is created, click on the tenant and go to the application menu. We can notice ingress gateway address and Kiali dashboard under "Service Endpoints" as shown in the blow snapshot.')])]),t._v(" "),a("p",[a("img",{attrs:{src:s(400),alt:""}})]),t._v(" "),a("h4",{attrs:{id:"access-the-kubernetes-cluster"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access-the-kubernetes-cluster"}},[t._v("#")]),t._v(" Access the Kubernetes Cluster")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Navigate to Dashboard, download kubeconfig and upload to the installer machine. Export the downloaded config file to KUBECONFIG to access the cluster.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KUBECONFIG")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("kubeconfig_file_path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Get node details by running below command.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get nodes\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Get namespace details by running below command.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubect get ns\n")])])]),a("p",[a("img",{attrs:{src:s(401),alt:""}})])])]),t._v(" "),a("h4",{attrs:{id:"deploy-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-application"}},[t._v("#")]),t._v(" Deploy Application")]),t._v(" "),a("ol",[a("li",[t._v("Application will be deployed under Istio tenant namespace. Execute below command to deploy application. Here we are using sample application provided by Istio")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl apply -f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://raw.githubusercontent.com/istio/istio/release-1.8/samples/bookinfo/platform/kube/bookinfo.yaml"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("Output of the above command looks like below.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(402),alt:""}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Verify if Pods and Services are running.")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(403),alt:""}})]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Verify the application status by running below command.")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kubectl get pod -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ratings -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{.items[0].metadata.name}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('"')]),t._v(" -c ratings -- "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" productpage:9080/productpage\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Deploy ingress gateway for application.")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl apply -f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://raw.githubusercontent.com/istio/istio/release-1.8/samples/bookinfo/networking/bookinfo-gateway.yaml"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("Verify gateway status by running below command.")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl get gateway\n")])])]),a("p",[a("img",{attrs:{src:s(404),alt:""}})]),t._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[t._v("Edit the gateway and provide a custom domain.")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" kubectl edit gateway bookinfo-gateway\n")])])]),a("ol",{attrs:{start:"7"}},[a("li",[a("p",[t._v("Modify the hosts section under spec with domain (Ex: mybook.example.com) as shown in screenshot.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(405),alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("Note Istio ingress hostname and port under "),a("strong",[t._v("Service Endpoints")]),t._v(" in Kubernetes Application.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(406),alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("Update hosts file as below so that when accessing application domain, domain points to ingress IP address")]),t._v(" "),a("p",[a("img",{attrs:{src:s(407),alt:""}})])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("In above example agw1.ajay.tennet.local resolves to 10.0.72.180")])]),t._v(" "),a("ol",{attrs:{start:"10"}},[a("li",[a("p",[t._v("Access the application via browser using custom domain and ingress port as below. Different versions of website will be loaded each time when website is accessed.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(408),alt:""}})])])]),t._v(" "),a("p",[a("strong",[t._v("Access Kiali")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Open HPECP WEBUI and under Istio tenant access the Kiali URL under application/service Endpoints")]),t._v(" "),a("p",[a("img",{attrs:{src:s(409),alt:""}})])]),t._v(" "),a("li",[a("p",[t._v("A popup window will be appearing with token key and to proceed to Kiali. Copy the token and when asked at login, provide this token")])]),t._v(" "),a("li",[a("p",[t._v('Once Kiali dashboard is loaded, go to service section and click "review" service of the website.')]),t._v(" "),a("p",[a("img",{attrs:{src:s(410),alt:""}})])]),t._v(" "),a("li",[a("p",[t._v('Notice that service has 3 versions of microservices as shown in below graph. We can restrict the flow of traffic by using option "Update Weighted Routing" under Actions.')]),t._v(" "),a("p",[a("img",{attrs:{src:s(411),alt:""}})])]),t._v(" "),a("li",[a("p",[t._v('Below is snippet of traffic allowed only to version 2 of "reviews" microservice application.')]),t._v(" "),a("p",[a("img",{attrs:{src:s(412),alt:""}})])])])])}),[],!1,null,null,null);e.default=o.exports}}]);