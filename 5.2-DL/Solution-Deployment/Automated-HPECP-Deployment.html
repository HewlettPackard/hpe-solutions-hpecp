<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Automated HPE Ezmeral Container Platform deployment | HPE EZMERAL CONTAINER PLATFORM 5.2 AND HPE EZMERAL DATA FABRIC ON HPE DL SERVERS</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-hpecp/5.2-DL/assets/css/0.styles.e9880461.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.2-DL/assets/js/app.dd6b52cc.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.2-DL/assets/js/2.b184eb69.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.2-DL/assets/js/27.fce55436.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/10.6b38407a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/11.8c5bbc2b.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/12.c7e4c0bf.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/13.d2a69700.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/14.baa7caa6.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/15.b0aef8fd.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/16.aedb41e9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/17.1d494768.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/18.fb95fb61.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/19.cba6e74c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/20.df48fb3a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/21.75b7039d.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/22.eecc5564.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/23.1ecffb4a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/24.f883ddc0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/25.109ad33a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/26.ff745f72.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/28.16bcd6c4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/29.4070eefd.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/3.ff6b14f5.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/30.71926e53.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/31.f537a6dc.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/32.e13ba8e9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/4.131e772a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/5.8d190c43.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/6.bb4245c0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/7.fa8cb543.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/8.8a3b4bb7.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.2-DL/assets/js/9.5c3a8c9f.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.2-DL/assets/css/0.styles.e9880461.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.2-DL/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL CONTAINER PLATFORM 5.2 AND HPE EZMERAL DATA FABRIC ON HPE DL SERVERS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.2-DL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.2-DL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE Ezmeral Container Platform 5.2 on HPE DL Servers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Solution-Deployment-Flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Host configuration</a></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Deploying-OS-On-Bare-Metal-Nodes.html" class="sidebar-link">Deploying operating system on bare-metal nodes</a></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Preparing-SLES-15-Hosts-For-HPECP-Installation.html" class="sidebar-link">Preparing SLES 15 hosts for HPECP installation</a></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Automated-HPECP-Deployment.html" aria-current="page" class="active sidebar-link">Automated HPE Ezmeral Container Platform deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Automated-HPECP-Deployment.html#automated-deployment" class="sidebar-link">Automated Deployment</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Manually-Install-And-Configure-HPECP.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Container Platform 5.2</a></li><li><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/HPECP-Airgap-Installation.html" class="sidebar-link">HPECP Airgap Installation</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="automated-hpe-ezmeral-container-platform-deployment"><a href="#automated-hpe-ezmeral-container-platform-deployment" class="header-anchor">#</a> Automated HPE Ezmeral Container Platform deployment</h1> <p>Usage of Ansible playbooks to deploy the HPE Ezmeral Container Platform
is automated and eliminates manual intervention. Ansible playbooks
provides the following functionalities for the installation user to
deploy HPE Ezmeral Container Platform.</p> <ul><li><p>Install the controller nodes</p></li> <li><p>Add gateway nodes or gateway HA</p></li> <li><p>Install EPIC worker nodes</p></li> <li><p>Enable controller HA</p></li> <li><p>Add or remove hosts on the Kubernetes cluster</p></li> <li><p>Create, update and delete Kubernetes cluster</p></li> <li><p>Create and manage tenants</p></li></ul> <div class="custom-block warning"><p class="custom-block-title">PREREQUISITES</p> <ul><li><p>Any Ansible Linux machine with Ansible 2.9.x and python 3.x.</p></li> <li><p>Minimum five (5) nodes with SLES 15 SP2 or CentOS 7.6 or higher version or RHEL (nodes can be VMs or BareMetal) required for HEPCP Deployment. One node for controller, one node for gateway, one master and two worker nodes.</p></li> <li><p>Playbooks are used to download the tools (epicctl, kubectl,
kubectl-hpecp-plugin and jq). They should be placed in /usr/local/bin -
epicctl - kubectl - kubectl-hpecp plugin -- jq.</p></li> <li><p>Obtain the URL of the HPE Ezmeral Container Platform bundle (using s3
bucket).</p></li></ul></div> <p><img src="/hpe-solutions-hpecp/5.2-DL/assets/img/SD-AH-1.51613a4c.png" alt=""></p> <p><strong>Figure 14:</strong> High Level Automated Deployment Flow Diagram</p> <h2 id="automated-deployment"><a href="#automated-deployment" class="header-anchor">#</a> Automated Deployment</h2> <ul><li><p>Update the values in <em>vars.yml</em> and <em>hosts inventory file</em> according
to your environment.</p></li> <li><p>Use following command to edit <em>vars.yml</em> file. <em>vars.yml</em> file contains the configuration environment variables and host inventory includes the host ip addresses.</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit group_vars/all/vars.yml
</code></pre></div><p>HPECP can be deployed by running <strong>site.yml</strong> or by running
individual playbooks. Each playbook description can be found further in
this document.</p> <ul><li>To build complete setup:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook -i hosts site.yml --ask-vault-pass
</code></pre></div><ul><li>In case if user want to deploy through individual playbooks. Sequence of
playbooks to be followed are:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/download-tools.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/controller.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/gateway.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/epic-workers.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/controller-ha.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/k8s-hosts.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/k8s-cluster.yml --ask-vault-pass

<span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/k8s-tenant.yml --ask-vault-pass
</code></pre></div><h3 id="playbooks-details"><a href="#playbooks-details" class="header-anchor">#</a> Playbooks Details:</h3> <ul><li><strong>site.yml</strong></li></ul> <p>This playbook contains the script to build complete setup.</p> <ul><li><strong>download-tools.yml</strong></li></ul> <p>This playbook contains the script to download required tools epictl,
kubectl, kubectl-hpecp plugin and jq</p> <ul><li><strong>controller.yml</strong></li></ul> <p>This playbook contains the script to deploy controller and configuring
the controller based on the configuration details provided in the
vars.yml file.</p> <ul><li><strong>gateway.yml</strong></li></ul> <p>This playbook contains the script to add gateways. User can add multiple
gateways by providing ip and host information in vars.yml file and
provide ip details in hosts inventory file.</p> <ul><li><strong>epic-workers.yml</strong></li></ul> <p>This playbook contains the script to add epic worker nodes. Provide epic
worker details in vars.yml and in hosts inventory file.</p> <ul><li><strong>controller-ha.yml</strong></li></ul> <p>This playbook contains the script to enable controller ha. Users need to
provide virtual ip with FQDN in vars.yml file to configure controller ha
and provide ip details in hosts file. Please make sure virtual ip
details present in DNS entries.</p> <p>Users need to run <strong>playbooks/epic-workers.yml</strong> playbook
first to add required epic worker nodes. And then run
playbooks/controller-ha.yml playbook.</p> <ul><li><strong>k8s-hosts.yml</strong></li></ul> <p>This playbook contains the script to add k8s nodes and Data Fabric nodes.
Provide k8s nodes information in vars.yml and hosts file.</p> <ul><li><strong>k8s-cluster.yml</strong></li></ul> <p>This playbook contains the script to create kubernetes compute cluster
and Data Fabric cluster. Provide cluster details in vars.yml</p> <ul><li><strong>k8s-tenant.yml</strong></li></ul> <p>This playbook contains the script to create tenant. Provide tenant
details in vars.yml.</p> <h3 id="uninstall-information"><a href="#uninstall-information" class="header-anchor">#</a> Uninstall Information:</h3> <p>If user want to uninstall HPE Ezmeral Container Platform and start a
fresh installation, use the following playbook.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/uninstall-bds.yml --ask-vault-pass
</code></pre></div><h3 id="other-playbooks"><a href="#other-playbooks" class="header-anchor">#</a> Other Playbooks:</h3> <ul><li>Run the following command to disable controller ha.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/disable-controller-ha.yml --ask-vault-pass
</code></pre></div><ul><li>Run the following command to delete epic workers.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/epic-workers-delete.yml --ask-vault-pass
</code></pre></div><ul><li>Run the following command to delete k8 nodes.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/k8s-delete-hosts.yml --ask-vault-pass
</code></pre></div><ul><li>Run the following command to update tenant.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/k8s-update-tenant.yml --ask-vault-pass
</code></pre></div><ul><li>Run the following command to delete the tenant.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/k8s-delete-tenant.yml --ask-vault-pass
</code></pre></div><ul><li>Run the following command to delete the cluster</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ansible-playbook -i hosts playbooks/k8s-cluster-delete.yml --ask-vault-pass
</code></pre></div><ul><li>For detailed steps, see the HPE Ezmeral Container Platform on HPE DL Servers Deployment guide available at,
<a href="https://github.com/hewlettpackard/hpe-solutions-hpecp/5.2-DL" target="_blank" rel="noopener noreferrer">https://github.com/hewlettpackard/hpe-solutions-hpecp/5.2-DL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Preparing-SLES-15-Hosts-For-HPECP-Installation.html" class="prev">
        Preparing SLES 15 hosts for HPECP installation
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.2-DL/Solution-Deployment/Manually-Install-And-Configure-HPECP.html">
        Manually Install and configure HPE Ezmeral Container Platform 5.2
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.2-DL/assets/js/app.dd6b52cc.js" defer></script><script src="/hpe-solutions-hpecp/5.2-DL/assets/js/2.b184eb69.js" defer></script><script src="/hpe-solutions-hpecp/5.2-DL/assets/js/27.fce55436.js" defer></script>
  </body>
</html>
