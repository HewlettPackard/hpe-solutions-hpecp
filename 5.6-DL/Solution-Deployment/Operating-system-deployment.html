<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploying operating system on bare-metal nodes | HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/css/0.styles.279e6b91.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/app.0405c966.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/2.fca4e8e3.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/25.08db4181.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/10.158a4e6a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/11.e7a729e8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/12.8d8de7ec.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/13.1fa676d3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/14.b727f089.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/15.698a95a3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/16.d1ab31b5.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/17.d858bae4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/18.48cebcf1.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/19.7c1da293.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/20.baa49df9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/21.c305abf2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/22.0b015e54.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/23.6617419f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/24.2c932679.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/26.660ea81c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/27.03cefdbd.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/28.0e032dd9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/29.93cd8dc2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/3.38136c3f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/4.23bc7f74.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/5.0eb3e2b0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/6.e1cdddcd.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/7.aaaabdb8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/8.78249944.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/9.baf987e9.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.6/assets/css/0.styles.279e6b91.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.6/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Solution-deployment-flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Host Configuration</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Operating-system-deployment.html" aria-current="page" class="active sidebar-link">Deploying operating system on bare-metal nodes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Operating-system-deployment.html#installation" class="sidebar-link">Installation</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Preparing-SLES15-hosts.html" class="sidebar-link">Preparing SLES 15 hosts for HPERE installation</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Automated-ERE-Deployment.html" class="sidebar-link">Automated HPE Ezmeral Runtime Enterprise deployment</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Manual-ERE-Deployment.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Runtime Enterprise 5.6.0</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/HPERE-Airgap-Installation.html" class="sidebar-link">HPERE Airgap Installation</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deploying-operating-system-on-bare-metal-nodes"><a href="#deploying-operating-system-on-bare-metal-nodes" class="header-anchor">#</a> Deploying operating system on bare-metal nodes</h1> <p><img src="/hpe-solutions-hpecp/5.6/assets/img/figure12.46c634fd.png" alt=""></p> <p>Figure 12: High Level Flow diagram of the OS Deployment Process</p> <div class="custom-block tip"><p class="custom-block-title">Pre-requisites</p> <ul><li>Centos 7 or RHEL <a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Host-Configuration.html#installer-machine">Installer machine</a> with the following configurations is essential to initiate the OS deployment process.
<ol><li>At least 600 GB disk space (especially in the “/” partition), 4 CPU cores and 8GB RAM.</li> <li>1 network interface with static IP address configured on same network as the management plane of the bare-metal servers and has access to internet.</li> <li>Python 3.6 or above is present and latest version associated pip is present.</li> <li>Ansible 2.9 should be installed</li> <li>OS ISO image is present in the HTTP file path within the installer machine.</li> <li>Ensure that SELinux status is disabled.</li></ol></li></ul></div> <h3 id="suse-hosts-configuration"><a href="#suse-hosts-configuration" class="header-anchor">#</a> SUSE hosts Configuration</h3> <div class="language- extra-class"><pre><code>* 2 network interfaces for the production network

* 1 local drive to be used as the boot device

* Boot mode is set to UEFI

* Boot order – Hard disk

* Secure Boot – disabled
</code></pre></div><h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <ol><li>Enable Python3 and Ansible Environment as mentioned in Installer machine section of deployment guide.</li> <li>Setup the installer machine.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">sh</span> setup.sh
</code></pre></div><p>Enter the installer machine OS. (“rhel7” for RHEL OS and “centos7” for Centos OS)</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Run the below command to fix any unwanted space, tabs error.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> ‘s/r$//’ <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>/setup.sh
</code></pre></div></div> <ol start="3"><li>Execute <strong>setup.sh</strong> script to install requirements for os deployment. Script expects the installer machine OS type, Please enter &quot;rhel7&quot; if the installer machine OS type is RHEL or &quot;centos7&quot; if the installer machine OS type is CentOS.</li></ol> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Run the below command to fix any unwanted space, tabs error.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/r$//'</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>/setup.sh
</code></pre></div></div> <ol start="4"><li>The vars.yml file contains config and server section, both of which needs to be updated with values for all the variables present within them.</li></ol> <p>a. Edit config section in vars.yml file present in “$BASE_DIR/group_vars/all/” folder with the following command and add the details of web server and operating system to be installed.
Default password for Ansible Vault file “vars.yml” is <strong>changeme</strong>.</p> <p>Command to edit vars.yml</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit vars.yml
</code></pre></div><p>b. Example values for the input configuration is as follows</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">{</span>
“HTTP_server_base_url” <span class="token builtin class-name">:</span> “http://10.0.x.x/”,
“HTTP_file_path” <span class="token builtin class-name">:</span> “/usr/share/nginx/html/”,
“OS_type” <span class="token builtin class-name">:</span> “sles15”,
“OS_image_name” <span class="token builtin class-name">:</span> “<span class="token operator">&lt;</span>os_iso_image_name_with_extension<span class="token operator">&gt;</span>”
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Acceptable values for “OS_type” variable is “sles15” for SUSE 15 SP3.</p></div> <p>c. Edit server section in vars.yml file present in “$BASE_DIR/group_vars/all/” folder
Example values for the input configuration for deploying SLES 15 SP3 is as follows.</p> <div class="custom-block tip"><p class="custom-block-title">Note</p> <ul><li>It is recommended to provide a complex password for the “Host_Password” variable.</li></ul></div> <div class="language-bash extra-class"><pre class="language-bash"><code>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        “Server_serial_number” <span class="token builtin class-name">:</span> “MXxxxxxDP”,
        “ILO_Address” <span class="token builtin class-name">:</span> “10.0.x.x”,
        “ILO_Username” <span class="token builtin class-name">:</span> “username”,
        “ILO_Password” <span class="token builtin class-name">:</span> “password”,
        “Hostname” <span class="token builtin class-name">:</span> “sles01.twentynet.local”,
        “NodeRole” <span class="token builtin class-name">:</span> “controller”,
        “Bonding_Interface1” <span class="token builtin class-name">:</span> “eth*”,
        “Bonding_Interface2” <span class="token builtin class-name">:</span> “eth*”,
        “Host_IP” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Username” <span class="token builtin class-name">:</span> “root”,
        “Host_Password” <span class="token builtin class-name">:</span> “Password”,
        “Host_Netmask” <span class="token builtin class-name">:</span> “255.x.x.x”,
        “Host_Prefix” <span class="token builtin class-name">:</span> “8”,
        “Host_Gateway” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_DNS” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Search” <span class="token builtin class-name">:</span> “twentynet.local”,
        “GPU_Host” <span class="token builtin class-name">:</span> “yes”
    <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span>
        “Server_serial_number” <span class="token builtin class-name">:</span> “MXxxxxxDQ”,
        “ILO_Address” <span class="token builtin class-name">:</span> “10.0.x.x”,
        “ILO_Username” <span class="token builtin class-name">:</span> “username”,
        “ILO_Password” <span class="token builtin class-name">:</span> “password”,
        “Hostname” <span class="token builtin class-name">:</span> “sles02.twentynet.local”,
        “NodeRole” <span class="token builtin class-name">:</span> “gateway”,
        “Bonding_Interface1” <span class="token builtin class-name">:</span> “eth*”,
        “Bonding_Interface2” <span class="token builtin class-name">:</span> “eth*”,
        “Host_IP” <span class="token builtin class-name">:</span> “20.0.x.x”,
        “Host_Username” <span class="token builtin class-name">:</span> “root”,
        “Host_Password” <span class="token builtin class-name">:</span> “Password”,
        “Host_Netmask” <span class="token builtin class-name">:</span> “255.x.x.x”,
        “Host_Prefix” <span class="token builtin class-name">:</span> “8”,
        “Host_Gateway” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_DNS” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Search” <span class="token builtin class-name">:</span> “twentynet.local”,
        “GPU_Host” <span class="token builtin class-name">:</span> “No”
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Acceptable values for “GPU_Host” variable is “yes” for host which has GPU cards and “No” for hosts which do not have GPU cards.</p></div> <ol start="5"><li>Change the current working directory to &quot;$BASE_DIR&quot; and execute the playbook to deploy operating system using the following command.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$BASE_DIR</span>
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/os_deployment.yml --ask-vault-pass
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <ol><li>Generic settings done as part of kickstart file for SLES are as follows. It is recommended that the user reviews and modifies the kickstart files (autoinst.xml file) to suit their requirements.</li></ol> <ul><li><p>Minimal Installation</p></li> <li><p>Language – en_US</p></li> <li><p>Keyboard &amp; layout – US</p></li> <li><p>Partition</p></li> <li><p>/boot/efi ,fstype=”vfat” ,size=500MiB</p></li> <li><p>root, size = 150G</p></li> <li><p>srv , size = 100G</p></li> <li><p>swap, size = 62.96G</p></li> <li><p>var, size = 100G</p></li> <li><p>home, size = 25G</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Specified Partitions are inline with HPERE implementation and is advised not to make changes to this.</p></div></li> <li><p>timezone – America/NewYork</p></li> <li><p>NIC teaming is performed with devices as specified in Bonding_Interface field of vars.yml, server section of the input file.
It is further assigned with the Host_IP, Netmask, Domain as defined in the input file.</p> <ul><li>Signature handling (accepting file without checksum, with non-trusted gpg key, unsigned file etc) is disabled by default to avoid any pop-ups and warnings and have an unattended installation. These properties can be modified according to the requirements in kickstart_files/autoinst.xml.</li></ul></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>accept_file_without_checksum
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_file_without_checksum<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_non_trusted_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_non_trusted_gpg_key<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_unknown_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_unknown_gpg_key<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_unsigned_file
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_unsigned_file<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_verification_failed
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span>/accept_verification_failed<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>import_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/import_gpg_key<span class="token operator">&gt;</span>
</code></pre></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Host-Configuration.html" class="prev">
        Host Configuration
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Preparing-SLES15-hosts.html">
        Preparing SLES 15 hosts for HPERE installation
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.6/assets/js/app.0405c966.js" defer></script><script src="/hpe-solutions-hpecp/5.6/assets/js/2.fca4e8e3.js" defer></script><script src="/hpe-solutions-hpecp/5.6/assets/js/25.08db4181.js" defer></script>
  </body>
</html>
