<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Automated HPE Ezmeral Runtime Enterprise deployment | HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/css/0.styles.279e6b91.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/app.5eb3f62d.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/2.fca4e8e3.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6/assets/js/24.8e3f5155.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/10.f72b1bc4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/11.e7a729e8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/12.8d8de7ec.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/13.1fa676d3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/14.b727f089.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/15.68fff555.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/16.8e3946ff.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/17.1a766592.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/18.25785d36.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/19.a51d4ada.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/20.4bdc3691.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/21.b46c2990.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/22.aa02a81f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/23.380c9844.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/25.cc3c1d5b.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/26.660ea81c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/27.25440428.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/28.36e5fac4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/29.07727917.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/3.5da8aeaf.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/4.23bc7f74.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/5.d1a782d6.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/6.7d9e5104.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/7.ae9e8e36.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/8.031d06a3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6/assets/js/9.09279ca2.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.6/assets/css/0.styles.279e6b91.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.6/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL USING REST API BASED DEPLOYMENT</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Solution-deployment-flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Host Configuration</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Operating-system-deployment.html" class="sidebar-link">Deploying operating system on bare-metal nodes</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Preparing-SLES15-hosts.html" class="sidebar-link">Preparing SLES 15 hosts for HPERE installation</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Automated-ERE-Deployment.html" aria-current="page" class="active sidebar-link">Automated HPE Ezmeral Runtime Enterprise deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Automated-ERE-Deployment.html#automated-deployment" class="sidebar-link">Automated Deployment</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Automated-ERE-Deployment.html#ere-deployment-through-air-gapped-environment" class="sidebar-link">ERE deployment through air-gapped environment</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Manual-ERE-Deployment.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Runtime Enterprise 5.6.0</a></li><li><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/HPERE-Airgap-Installation.html" class="sidebar-link">HPERE Airgap Installation</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="automated-hpe-ezmeral-runtime-enterprise-deployment"><a href="#automated-hpe-ezmeral-runtime-enterprise-deployment" class="header-anchor">#</a> Automated HPE Ezmeral Runtime Enterprise deployment</h1> <p>Usage of Ansible playbooks to deploy the HPE Ezmeral Runtime Enterprise is automated and eliminates manual intervention. Ansible playbooks provides the following functionalities for the installation user to deploy HPE Ezmeral Runtime Enterprise.</p> <ul><li><p>Install the SLES OS on bare metal servers</p></li> <li><p>Prepare the hosts for HPERE implementation</p></li> <li><p>Setup docker-registry to deploy ere through air-gapped environment</p></li> <li><p>Install the controller nodes</p></li> <li><p>Add gateway nodes, delete gateway nodes or enable gateway HA</p></li> <li><p>Add and delete EPIC worker nodes.</p></li> <li><p>Enable and Disable controller HA</p></li> <li><p>Add or remove hosts on the Kubernetes cluster</p></li> <li><p>Create and delete Kubernetes cluster</p></li> <li><p>Create and delete tenants</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">Prerequisites</p> <ul><li><p>Any Ansible Linux machine with Ansible 2.9.x and python 3.x.</p></li> <li><p>Minimum five (5) nodes with SLES 15 SP3 or CentOS 7.6 or higher version or RHEL (nodes can be VMs or BareMetal).</p></li> <li><p>Playbooks are used to download the tools (jq). They should be placed in /usr/local/bin.</p></li> <li><p>Obtain the URL of the HPE Ezmeral Runtime Enterprise bundle (using s3 bucket).</p></li></ul></div> <p><img src="/hpe-solutions-hpecp/5.6/assets/img/figure13.04333f08.png" alt=""></p> <p>Figure 13. Workflow diagram for Automated HPE Ezmeral Runtime Enterprise deployment</p> <h2 id="automated-deployment"><a href="#automated-deployment" class="header-anchor">#</a> Automated Deployment</h2> <ul><li><p>Update the values in <em>vars.yml</em> and <em>hosts inventory file</em> according to your environment.</p></li> <li><p>Use following command to edit <em>vars.yml</em> file. The vars.yml file contains the configuration environment variables and host inventory includes the host ip addresses.</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$BASE_DIR</span>
<span class="token operator">&gt;</span> ansible-vault edit group_vars/all/vars.yml
</code></pre></div><p>HPERE can be deployed by running <code>site.yml</code> or by running individual playbooks. Each playbook description can be found further in this document.</p> <ul><li>To build complete setup:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts site.yml --ask-vault-pass
</code></pre></div><ul><li>In case if user want to deploy through individual playbooks. Sequence of playbooks to be followed are:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/os_deployment.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/prepare_hosts.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/download-tools.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/controller.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/gateway-add.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/epic-workers-add.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/controller-ha.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-add-hosts.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-create-cluster.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-create-tenant.yml –ask-vault-pass
</code></pre></div><p><strong>Playbooks Details:</strong></p> <ul><li><strong>site.yml</strong></li></ul> <p>This playbook contains the script to deploy HPE Ezmeral Runtime Enterprise starting from the OS_deployment until tenant configuration.</p> <ul><li><strong>OS_deployment.yml</strong></li></ul> <p>This playbook contains the scripts to deploy SLES_OS on bare metal servers.</p> <ul><li><strong>Prepare_hosts.yml</strong></li></ul> <p>This playbook contains the script to prepare the hosts for HPERE deployment.</p> <ul><li><strong>Download-tools.yml</strong></li></ul> <p>This playbook downloads the jq under <code>/usr/local/bin</code> in the installer machine and provides executable permissions.</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>In case of facing any issues while running download-tools.yml playbook,Download tools manually from the following links, place it under <code>/usr/local/bin</code> and change executable permissions.</p> <ul><li>jq (https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64)</li></ul></div> <ul><li><strong>controller.yml</strong></li></ul> <p>This playbook contains the script to deploy controller and configuring the controller based on the configuaration details provided in the vars.yml file.</p> <ul><li><strong>Gateway-add.yml</strong></li></ul> <p>This playbook contains the script to add gateways. User can add multiple gateways by providing ip and host information in vars.yml file.</p> <ul><li><strong>Epic-workers-add.yml</strong></li></ul> <p>This playbook contains the script to add epic worker nodes. Provide epic worker details in vars.yml.</p> <ul><li><strong>Controller-ha.yml</strong></li></ul> <p>This playbook contains the script to enable controller ha. Users need to provide virtual ip with FQDN in vars.yml file to configure controller ha. Please make sure virtual ip details present in DNS entries.</p> <p>Users need to run <code>playbooks/epic-workers-add.yml</code> playbook first to add required epic worker nodes. And then run playbooks/controller-ha.yml playbook.</p> <ul><li><strong>K8s-add-hosts.yml</strong></li></ul> <p>This playbook contains the script to add k8 nodes and Data Fabric nodes. Provide k8 nodes information in vars.yml file.</p> <ul><li><strong>K8s-create-cluster.yml</strong></li></ul> <p>This playbook contains the script to create ubernetes cluster and DataFabric cluster. Provide cluster details in vars.yml file.</p> <ul><li><strong>k8s-create-tenant.yml</strong></li></ul> <p>This playbook contains the script to create tenant. Provide tenant details in vars.yml file.</p> <p><strong>Uninstall Information:</strong></p> <p>If user want to uninstall HPE Ezmeral Runtime Enterprise and start a fresh installation, use the following playbook.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/uninstall-bds.yml –ask-vault-pass 
</code></pre></div><p><strong>Other Playbooks:</strong></p> <p>Run the following command to disable controller ha.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/disable-controller-ha.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete epic workers.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/epic-workers-delete.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete k8 nodes.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-delete-hosts.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete the tenant.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-delete-tenant.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete the cluster</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-cluster-delete.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete gateway.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook playbooks/gateway-delete.yml –ask-vault-pass
</code></pre></div><h2 id="ere-deployment-through-air-gapped-environment"><a href="#ere-deployment-through-air-gapped-environment" class="header-anchor">#</a> ERE deployment through air-gapped environment</h2> <p>If user want ERE deployment through airgap mode, then perform below steps:</p> <ul><li>To setup docker registry update the details under airgap section in vars.yml and run below command to setup docker registry (registry server).</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/setup_docker_registry.yml –ask-vault-pass 
</code></pre></div><p><strong>setup_docker_registry.yml</strong></p> <p>This playbook contains the script to create, configure docker registry and copy all required docker images based on the configuaration details provided in the vars.yml file.</p> <div class="custom-block tip"><p class="custom-block-title">NOTE:</p> <p>After docker-registry setup is ready run the playbooks starts from controller installation shown in steps above which will deploy ERE through airgap environment.</p> <p>For more information check read.me file under &quot;ERE deployment through air-gapped environment&quot; in git repo <a href="https://github.com/HewlettPackard/hpe-solutions-hpecp/blob/master/LTI/ERE_RestAPI_Based_Deployment/README.md" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/hpe-solutions-hpecp/blob/master/LTI/ERE_RestAPI_Based_Deployment/README.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>For detailed steps, see the HPE Ezmeral Runtime Enterprise on HPE DL325 &amp; DL385 Deployment guide available at,
<a href="https://hewlettpackard.github.io/hpe-solutions-hpecp/5.6.0/" target="_blank" rel="noopener noreferrer">https://hewlettpackard.github.io/hpe-solutions-hpecp/5.6.0/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Preparing-SLES15-hosts.html" class="prev">
        Preparing SLES 15 hosts for HPERE installation
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.6/Solution-Deployment/Manual-ERE-Deployment.html">
        Manually Install and configure HPE Ezmeral Runtime Enterprise 5.6.0
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.6/assets/js/app.5eb3f62d.js" defer></script><script src="/hpe-solutions-hpecp/5.6/assets/js/2.fca4e8e3.js" defer></script><script src="/hpe-solutions-hpecp/5.6/assets/js/24.8e3f5155.js" defer></script>
  </body>
</html>
