<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Automated HPE Ezmeral Runtime Enterprise deployment | HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL INTEL USING REST API BASED DEPLOYMENT</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-hpecp/5.6-DL/assets/css/0.styles.411e0e73.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.6-DL/assets/js/app.368291b0.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6-DL/assets/js/2.bd3d0753.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.6-DL/assets/js/16.397dba7f.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/10.a2ea12b0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/11.51915c3e.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/12.d90a58c9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/13.c06042b9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/14.8f4a8ebc.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/15.0f1c4fc2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/17.09f19494.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/18.516a3f85.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/19.00239e5c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/20.6840390d.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/21.f4aa8039.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/22.8754022c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/23.e75a5ac2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/24.7943351b.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/25.fcea4234.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/26.2e649161.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/27.f955e33b.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/28.2be40c54.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/29.d575667a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/3.1c7f07ee.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/4.2206d0c4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/5.6f43dfef.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/6.691b977a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/7.d1db4fa3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/8.957fa150.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.6-DL/assets/js/9.54d536e7.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.6-DL/assets/css/0.styles.411e0e73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.6-DL/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL INTEL USING REST API BASED DEPLOYMENT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6-DL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.6-DL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE EZMERAL RUNTIME ENTERPRISE 5.6 ON DL INTEL USING REST API BASED DEPLOYMENT</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Solution-deployment-flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Preparing Installer Machine</a></li><li><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Automated-ERE-Deployment.html" aria-current="page" class="active sidebar-link">Automated HPE Ezmeral Runtime Enterprise deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Automated-ERE-Deployment.html#automated-deployment" class="sidebar-link">Automated Deployment</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Automated-ERE-Deployment.html#ere-deployment-through-air-gapped-environment" class="sidebar-link">ERE deployment through air-gapped environment</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Manual-ERE-Deployment.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Runtime Enterprise 5.6.1</a></li><li><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/HPERE-Airgap-Installation.html" class="sidebar-link">HPERE Airgap Installation</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources and additional links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="automated-hpe-ezmeral-runtime-enterprise-deployment"><a href="#automated-hpe-ezmeral-runtime-enterprise-deployment" class="header-anchor">#</a> Automated HPE Ezmeral Runtime Enterprise deployment</h1> <p>Usage of Ansible playbooks to deploy the HPE Ezmeral Runtime Enterprise is automated and eliminates manual intervention. Ansible playbooks provides the following functionalities for the installation user to deploy HPE Ezmeral Runtime Enterprise.</p> <ul><li><p>Install the SLES OS on bare metal servers</p></li> <li><p>Prepare the hosts for HPERE implementation</p></li> <li><p>Setup docker-registry to deploy ere through air-gapped environment</p></li> <li><p>Install the controller nodes</p></li> <li><p>Add gateway nodes, delete gateway nodes or enable gateway HA</p></li> <li><p>Add and delete Shadow &amp; Arbiter Controller</p></li> <li><p>Enable and Disable controller HA</p></li> <li><p>Add or remove hosts on the Kubernetes cluster</p></li> <li><p>Create and delete Kubernetes cluster</p></li> <li><p>Create and delete tenants</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">Prerequisites</p> <ul><li><p>Centos 7 or RHEL <a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Host-Configuration.html#installer-machine">Installer machine</a> with the following configurations is essential to initiate the OS deployment process.</p> <ol><li>At least 600 GB disk space (especially in the “/” partition), 4 CPU cores and 8GB RAM.</li> <li>1 network interface with static IP address configured on same network as the management plane of the bare-metal servers and has access to internet.</li> <li>Python 3.6 or above is present and latest version associated pip is present.</li> <li>Ansible 2.9 should be installed</li> <li>OS ISO image is present in the HTTP file path within the installer machine.</li> <li>Ensure that SELinux status is disabled.</li></ol></li> <li><p>Minimum five (5) nodes with SLES 15 SP3 or CentOS 7.6 or higher version or RHEL (nodes can be VMs or BareMetal).</p></li> <li><p>Playbooks are used to download the tools (jq). They should be placed in /usr/local/bin.</p></li> <li><p>Obtain the URL of the HPE Ezmeral Runtime Enterprise bundle (using s3 bucket).</p></li></ul></div> <p><img src="/hpe-solutions-hpecp/5.6-DL/assets/img/figure11.19d77189.png" alt=""></p> <p><strong>Figure 11.</strong> Workflow diagram for Automated HPE Ezmeral Runtime Enterprise deployment</p> <h2 id="automated-deployment"><a href="#automated-deployment" class="header-anchor">#</a> Automated Deployment</h2> <ul><li>Update the values in <em>vars.yml</em> and <em>hosts inventory file</em> according to your environment.</li></ul> <h3 id="input-file-changes-for-deploying-operating-system-on-bare-metal-nodes"><a href="#input-file-changes-for-deploying-operating-system-on-bare-metal-nodes" class="header-anchor">#</a> Input file changes for deploying operating system on bare-metal nodes</h3> <p><img src="/hpe-solutions-hpecp/5.6-DL/assets/img/figure12.38b22073.png" alt=""></p> <p><strong>Figure 12:</strong> High Level Flow diagram of the OS Deployment Process</p> <h3 id="suse-hosts-configuration"><a href="#suse-hosts-configuration" class="header-anchor">#</a> SUSE hosts Configuration</h3> <div class="language- extra-class"><pre><code>* 2 network interfaces for the production network

* 1 local drive to be used as the boot device

* Boot mode is set to UEFI

* Boot order – Hard disk

* Secure Boot – disabled
</code></pre></div><p>The vars.yml file contains config and server section, both of which needs to be updated with values for all the variables present within them.</p> <p>a. Edit config section in vars.yml file present in “$BASE_DIR/Lite_Touch_Installation/group_vars/all/” folder with the following command and add the details of web server and operating system to be installed.
Default password for Ansible Vault file “vars.yml” is <strong>changeme</strong>.</p> <p>Command to edit vars.yml</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit vars.yml
</code></pre></div><p>b. Example values for the input configuration is as follows</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">{</span>
“HTTP_server_base_url” <span class="token builtin class-name">:</span> “http://10.0.x.x/”,
“HTTP_file_path” <span class="token builtin class-name">:</span> “/usr/share/nginx/html/”,
“OS_type” <span class="token builtin class-name">:</span> “sles15”,
“OS_image_name” <span class="token builtin class-name">:</span> “<span class="token operator">&lt;</span>os_iso_image_name_with_extension<span class="token operator">&gt;</span>”
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Acceptable values for “OS_type” variable is “sles15” for SUSE 15 SP3.</p></div> <p>c. Edit server section in vars.yml file present in “$BASE_DIR/Lite_Touch_Installation/group_vars/all/” folder
Example values for the input configuration for deploying SLES 15 SP3 is as follows.</p> <div class="custom-block tip"><p class="custom-block-title">Note</p> <ul><li>It is recommended to provide a complex password for the “Host_Password” variable.</li></ul></div> <div class="language-bash extra-class"><pre class="language-bash"><code>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        “Server_serial_number” <span class="token builtin class-name">:</span> “MXxxxxxDP”,
        “ILO_Address” <span class="token builtin class-name">:</span> “10.0.x.x”,
        “ILO_Username” <span class="token builtin class-name">:</span> “username”,
        “ILO_Password” <span class="token builtin class-name">:</span> “password”,
        “Hostname” <span class="token builtin class-name">:</span> “sles01.twentynet.local”,
        “NodeRole” <span class="token builtin class-name">:</span> “controller”,
        “Bonding_Interface1” <span class="token builtin class-name">:</span> “eth*”,
        “Bonding_Interface2” <span class="token builtin class-name">:</span> “eth*”,
        “Host_IP” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Username” <span class="token builtin class-name">:</span> “root”,
        “Host_Password” <span class="token builtin class-name">:</span> “Password”,
        “Host_Netmask” <span class="token builtin class-name">:</span> “255.x.x.x”,
        “Host_Prefix” <span class="token builtin class-name">:</span> “8”,
        “Host_Gateway” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_DNS” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Search” <span class="token builtin class-name">:</span> “twentynet.local”,
        “GPU_Host” <span class="token builtin class-name">:</span> “yes”
    <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span>
        “Server_serial_number” <span class="token builtin class-name">:</span> “MXxxxxxDQ”,
        “ILO_Address” <span class="token builtin class-name">:</span> “10.0.x.x”,
        “ILO_Username” <span class="token builtin class-name">:</span> “username”,
        “ILO_Password” <span class="token builtin class-name">:</span> “password”,
        “Hostname” <span class="token builtin class-name">:</span> “sles02.twentynet.local”,
        “NodeRole” <span class="token builtin class-name">:</span> “gateway”,
        “Bonding_Interface1” <span class="token builtin class-name">:</span> “eth*”,
        “Bonding_Interface2” <span class="token builtin class-name">:</span> “eth*”,
        “Host_IP” <span class="token builtin class-name">:</span> “20.0.x.x”,
        “Host_Username” <span class="token builtin class-name">:</span> “root”,
        “Host_Password” <span class="token builtin class-name">:</span> “Password”,
        “Host_Netmask” <span class="token builtin class-name">:</span> “255.x.x.x”,
        “Host_Prefix” <span class="token builtin class-name">:</span> “8”,
        “Host_Gateway” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_DNS” <span class="token builtin class-name">:</span> “20.x.x.x”,
        “Host_Search” <span class="token builtin class-name">:</span> “twentynet.local”,
        “GPU_Host” <span class="token builtin class-name">:</span> “No”
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Acceptable values for “GPU_Host” variable is “yes” for host which has GPU cards and “No” for hosts which do not have GPU cards.</p> <p>Generic settings done as part of kickstart file for SLES are as follows. It is recommended that the user reviews and modifies the kickstart files (autoinst.xml file) to suit their requirements.</p> <ul><li><p>Minimal Installation</p></li> <li><p>Language – en_US</p></li> <li><p>Keyboard &amp; layout – US</p></li> <li><p>Partition</p></li> <li><p>/boot/efi ,fstype=”vfat” ,size=500MiB</p></li> <li><p>root, size = 150G</p></li> <li><p>srv , size = 100G</p></li> <li><p>swap, size = 62.96G</p></li> <li><p>var, size = 100G</p></li> <li><p>home, size = 25G</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Specified Partitions are inline with HPERE implementation and is advised not to make changes to this.</p></div></li> <li><p>timezone – America/NewYork</p></li> <li><p>NIC teaming is performed with devices as specified in Bonding_Interface field of vars.yml, server section of the input file.
It is further assigned with the Host_IP, Netmask, Domain as defined in the input file.</p> <ul><li>Signature handling (accepting file without checksum, with non-trusted gpg key, unsigned file etc) is disabled by default to avoid any pop-ups and warnings and have an unattended installation. These properties can be modified according to the requirements in kickstart_files/autoinst.xml.</li></ul></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&lt;</span>accept_file_without_checksum
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_file_without_checksum<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_non_trusted_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_non_trusted_gpg_key<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_unknown_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_unknown_gpg_key<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_unsigned_file
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/accept_unsigned_file<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>accept_verification_failed
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span>/accept_verification_failed<span class="token operator">&gt;</span>

+ <span class="token operator">&lt;</span>import_gpg_key
config:type<span class="token operator">=</span>”boolean”<span class="token operator">&gt;</span>true<span class="token operator">&lt;</span>/import_gpg_key<span class="token operator">&gt;</span>
</code></pre></div></div> <h3 id="input-file-changes-to-prepare-sles-15-hosts-for-hpere-installation"><a href="#input-file-changes-to-prepare-sles-15-hosts-for-hpere-installation" class="header-anchor">#</a> Input file changes to prepare SLES 15 hosts for HPERE installation</h3> <ul><li>Update vars.yml file with required detail for registration.</li></ul> <p>Edit vars.yml present in “$BASE_DIR/Lite_Touch_Installation/group_vars/all/” folder with the following command and enter the details listed below.
Command to edit vars.yml</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit vars.yml
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Default password for Ansible Vault file vars.yml is “changeme”.</p></div> <ul><li><p>Mode: There are two modes of registering the server to registration server, RMT and User Email. Permissible values are 1 (For registering the SUSE server to RMT) and 2 (For registering the SUSE server using Email)</p></li> <li><p>Mode 1: Registration using RMT server.</p> <ul><li>Update the Mode:1 section in vars.yml with the following inputs
<ol><li>RMT_URL: RMT server ip address.</li></ol></li></ul></li> <li><p>Mode 2: Registration using User Email Id and RegCode</p> <ul><li>Update the Mode:2 section in vars.yml with the following inputs
<ol><li>email: User Email-id which will be used for server registration.</li> <li>base_code:- Registration code which will be used for server registration.</li> <li>caas_code:- Registration code for caas module.</li> <li>ha_code:- Registration code for ha module.</li></ol></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">Note:</p> <div class="language- extra-class"><pre><code>1.  Email and Reg_codes are applicable only for Mode 2 else leave blank.
2.  sles_packages: sles modules which will be installed separated by comma.
3.  Zypper_packages: 27zypper packages which will be installed separated by comma.
</code></pre></div></div> <ul><li>Example values for the registration details in vars.yml are as follows.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#Mode 1 for RMT Registration and Mode 2 for User Registration</span>

Mode: <span class="token number">2</span>
Email: jim. ***@***.com
base_code: 8BAB9EC****
caas_code: 21E02******
ha_code: 87D73*****
RMT_URL: http://20.**.**.**

sles_packages: <span class="token punctuation">[</span>sle-module-public-cloud/15.6.0/x86_64,
sle-module-legacy/15.6.0/x86_64, sle-module-python2/15.6.0/x86_64,
sle-module-containers/15.6.0/x86_64,
sle-module-basesystem/15.6.0/x86_64,
sle-module-desktop-applications/15.6.0/x86_64<span class="token punctuation">]</span>

zypper_packages: <span class="token punctuation">[</span>iputils, bind-utils, autofs, libcgroup1,kernel-default-devel,gcc-c++,perl,pciutils,rsyslog,firewalld<span class="token punctuation">]</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note:</p> <p>Don’t modify the sles_packages and zypper_pacakges as these packages are required for HPERE implementation changes made to this section may impact the installation.</p> <p>During the playbook execution, while installing the packageHub Module it might throw an error in the first attempt. This is a known issue from SUSE and is being taken care by re-installing the module.</p> <p>Link for reference <a href="https://www.suse.com/support/kb/doc/?id=000019505" target="_blank" rel="noopener noreferrer">https://www.suse.com/support/kb/doc/?id=000019505<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>In case the script fails while checking the internet connection from the hosts, kindly cross verify the internet from the hosts and then re-run the script.</li> <li>While checking the apparomor service the error is expected as it verifies the apparmor service status on the hosts and if it running, it will stop and disable the same.</li></ul></div> <h3 id="automated-ere-deployment"><a href="#automated-ere-deployment" class="header-anchor">#</a> Automated ERE Deployment</h3> <ul><li>Use following command to edit <em>vars.yml</em> file. The vars.yml file contains the configuration environment variables and host inventory includes the host ip addresses.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$BASE_DIR</span>/Lite_Touch_Installation/
<span class="token operator">&gt;</span> ansible-vault edit group_vars/all/vars.yml
</code></pre></div><p>HPERE can be deployed by running <code>site.yml</code> or by running individual playbooks. Each playbook description can be found further in this document.</p> <ul><li>To build complete setup:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts site.yml --ask-vault-pass
</code></pre></div><ul><li>In case if user want to deploy through individual playbooks. Sequence of playbooks to be followed are:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/os_deployment.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/prepare_hosts.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/download-tools.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/controller.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/gateway-add.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/shadow-arbiter-add.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/controller-ha.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-add-hosts.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-create-cluster.yml –ask-vault-pass
<span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-create-tenant.yml –ask-vault-pass
</code></pre></div><p><strong>Playbooks Details:</strong></p> <ul><li><strong>site.yml</strong></li></ul> <p>This playbook contains the script to deploy HPE Ezmeral Runtime Enterprise starting from the OS_deployment until tenant configuration.</p> <ul><li><strong>OS_deployment.yml</strong></li></ul> <p>This playbook contains the scripts to deploy SLES_OS on bare metal servers.</p> <ul><li><strong>Prepare_hosts.yml</strong></li></ul> <p>This playbook contains the script to prepare the hosts for HPERE deployment.</p> <ul><li><strong>Download-tools.yml</strong></li></ul> <p>This playbook downloads the jq under <code>/usr/local/bin</code> in the installer machine and provides executable permissions.</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>In case of facing any issues while running download-tools.yml playbook,Download tools manually from the following links, place it under <code>/usr/local/bin</code> and change executable permissions.</p> <ul><li>jq (<a href="https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64" target="_blank" rel="noopener noreferrer">https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li></ul></div> <ul><li><strong>controller.yml</strong></li></ul> <p>This playbook contains the script to deploy controller and configuring the controller based on the configuaration details provided in the vars.yml file.</p> <ul><li><strong>Gateway-add.yml</strong></li></ul> <p>This playbook contains the script to add gateways. User can add multiple gateways by providing ip and host information in vars.yml file.</p> <ul><li><strong>Shadow-arbiter-add.yml</strong></li></ul> <p>This playbook contains the script to add arbiter and shadow controller nodes. Provide arbiter and shadow  details in vars.yml.</p> <ul><li><strong>Controller-ha.yml</strong></li></ul> <p>This playbook contains the script to enable controller ha. Users need to provide virtual ip with FQDN in vars.yml file to configure controller ha. Please make sure virtual ip details present in DNS entries.</p> <p>Users need to run <code>playbooks/shadow-arbiter-add.yml</code> playbook first to add required arbiter and cshadow controller nodes. And then run playbooks/controller-ha.yml playbook.</p> <ul><li><strong>K8s-add-hosts.yml</strong></li></ul> <p>This playbook contains the script to add k8 nodes and Data Fabric nodes. Provide k8 nodes information in vars.yml file.</p> <ul><li><strong>K8s-create-cluster.yml</strong></li></ul> <p>This playbook contains the script to create ubernetes cluster and DataFabric cluster. Provide cluster details in vars.yml file.</p> <ul><li><strong>k8s-create-tenant.yml</strong></li></ul> <p>This playbook contains the script to create tenant. Provide tenant details in vars.yml file.</p> <p><strong>Uninstall Information:</strong></p> <p>If user want to uninstall HPE Ezmeral Runtime Enterprise and start a fresh installation, use the following playbook.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/uninstall-bds.yml –ask-vault-pass 
</code></pre></div><p><strong>Other Playbooks:</strong></p> <p>Run the following command to disable controller ha.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/disable-controller-ha.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete arbiter and shadow controller nodes.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/shadow-arbiter-delete.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete k8 nodes.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-delete-hosts.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete the tenant.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-delete-tenant.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete the cluster</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/k8s-cluster-delete.yml –ask-vault-pass 
</code></pre></div><p>Run the following command to delete gateway.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook playbooks/gateway-delete.yml –ask-vault-pass
</code></pre></div><h2 id="ere-deployment-through-air-gapped-environment"><a href="#ere-deployment-through-air-gapped-environment" class="header-anchor">#</a> ERE deployment through air-gapped environment</h2> <p>If user want ERE deployment through airgap mode, then perform below steps:</p> <ul><li>To setup docker registry update the details under airgap section in vars.yml and run below command to setup docker registry (registry server).</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts playbooks/setup_docker_registry.yml –ask-vault-pass 
</code></pre></div><p><strong>setup_docker_registry.yml</strong></p> <p>This playbook contains the script to create, configure docker registry and copy all required docker images based on the configuaration details provided in the vars.yml file.</p> <div class="custom-block tip"><p class="custom-block-title">NOTE:</p> <p>Above individual docker-registry playbook setup docker-registry once registry is up user can run site.yml for complete ere deployment through airgap mode.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook <span class="token parameter variable">-i</span> hosts site.yml --ask-vault-pass
</code></pre></div><p>For more information check read.me file under &quot;ERE deployment through air-gapped environment&quot; in git repo <a href="https://github.com/HewlettPackard/hpe-solutions-hpecp/blob/master/LTI/Lite_Touch_Installation/README.md" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/hpe-solutions-hpecp/blob/master/LTI/Lite_Touch_Installation/README.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>For detailed steps, see the HPE Ezmeral Runtime Enterprise on HPE DL360 &amp; DL380 Deployment guide available at,
<a href="https://hewlettpackard.github.io/hpe-solutions-hpecp/5.6-DL-INTEL/" target="_blank" rel="noopener noreferrer">https://hewlettpackard.github.io/hpe-solutions-hpecp/5.6-DL-INTEL/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Host-Configuration.html" class="prev">
        Preparing Installer Machine
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.6-DL/Solution-Deployment/Manual-ERE-Deployment.html">
        Manually Install and configure HPE Ezmeral Runtime Enterprise 5.6.1
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.6-DL/assets/js/app.368291b0.js" defer></script><script src="/hpe-solutions-hpecp/5.6-DL/assets/js/2.bd3d0753.js" defer></script><script src="/hpe-solutions-hpecp/5.6-DL/assets/js/16.397dba7f.js" defer></script>
  </body>
</html>
