(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{423:function(e,t,a){e.exports=a.p+"assets/img/Flow2.627b02f0.png"},446:function(e,t,a){"use strict";a.r(t);var s=a(42),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"server-profile-overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server-profile-overview"}},[e._v("#")]),e._v(" Server Profile Overview")]),e._v(" "),s("p",[e._v("This section consists of an overview about the server profile automation done and the ansible playbooks developed to automate the tasks such as uploading firmware baseline iso package to OneView, creating server profile template & server profiles in HPE OneView.")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("Prerequisites")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Ansible engine with Ansible 2.9.x and Python 3.6.x")])]),e._v(" "),s("li",[s("p",[s("strong",[e._v("Python module for HPE OneView")]),e._v(": hpOneView is the Python SDK for the OneView API that allows you to manage OneView functionalities. Download the python repository at "),s("a",{attrs:{href:"https://github.com/HewlettPackard/oneview-python",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/HewlettPackard/oneview-python"),s("OutboundLink")],1)])]),e._v(" "),s("li",[s("p",[s("strong",[e._v("Ansible module for HPE OneView")]),e._v(": OneView-ansible is the Ansible Module for HPE OneView which utilizes the python SDK to enable infrastructure as a code. Download the repository at "),s("a",{attrs:{href:"https://github.com/HewlettPackard/oneview-ansible/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/HewlettPackard/oneview-ansible/"),s("OutboundLink")],1)])]),e._v(" "),s("li",[s("p",[s("strong",[e._v("Ansible configuration file")]),e._v(": By default,the "),s("strong",[e._v("forks")]),e._v(" parameter in "),s("strong",[e._v("Ansible")]),e._v(" is limited to 5, please increase the value to number of hosts that are getting configured using this playbook.")])])])]),e._v(" "),s("p",[e._v("Flow Diagram 2 shows the high level flow of the server profile automation.")]),e._v(" "),s("p",[s("img",{attrs:{src:a(423),alt:""}})]),e._v(" "),s("p",[s("strong",[e._v("Flow Diagram 2.")]),e._v(" Workflow diagram for automated Server Profile deployment")]),e._v(" "),s("h2",{attrs:{id:"software-requirements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#software-requirements"}},[e._v("#")]),e._v(" Software requirements")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("Software")]),e._v(" "),s("th",[e._v("Version")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("HPE OneView")]),e._v(" "),s("td",[e._v("5.2")])]),e._v(" "),s("tr",[s("td",[e._v("CentOS")]),e._v(" "),s("td",[e._v("7.6")])])])]),e._v(" "),s("h2",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[e._v("#")]),e._v(" Usage")]),e._v(" "),s("ul",[s("li",[e._v("Execute the following command to switch to infrastructure directory."),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" BASE_DIR/infrastructure\n")])])])])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("ol",[s("li",[e._v("BASE_DIR is defined and set in "),s("RouterLink",{attrs:{to:"/Solution-Deployment/Host-Configuration.html#installer-machine"}},[e._v("Installer machine")]),e._v(" section in deployment guide.")],1),e._v(" "),s("li",[e._v("Enable Python3 and Ansible Environment as mentioned in "),s("RouterLink",{attrs:{to:"/Solution-Deployment/Host-Configuration.html#installer-machine"}},[e._v("Installer machine")]),e._v(" section of deployment guide.")],1),e._v(" "),s("li",[e._v("Run "),s("code",[e._v("which python3")]),e._v(" command to get the ansible_python interpreter value. Assign this value to ansible_python_interpreter variable in input.yml.")])])]),e._v(" "),s("ul",[s("li",[s("p",[e._v("It is mandatory to update all the input files (inputs.yml, hosts, secret.yml, fw_version_inputs.yml) with appropriate values before running any playbooks available in this repository.")])]),e._v(" "),s("li",[s("p",[e._v("Update the inventory(hosts), ansible vault(secret.yml), variable file(input.yml) and firmware version variable file (fw_version_inputs.yml) with the appropriate values.")])]),e._v(" "),s("li",[s("p",[e._v("Input file name: hosts")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("This file is an inventory of host details.")])]),e._v(" "),s("li",[s("p",[e._v('Variables from "hosts" that are required by playbooks under "infrastructure" directory are listed here:')]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# [server_profile_template] ")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# [server_profile]")]),e._v("\n")])])])])])])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("ul",[s("li",[s("p",[e._v('It\'s recommended to use the same server type (ex:type="SY 480 Gen10 1",type="SY 480 Gen10 2",..) for server profile template and assign the same server type to the server profile.')])]),e._v(" "),s("li",[s("p",[e._v("To use multiple server types, create server profile template for each server type and assign it to the same server type to server profile.")])])])]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Input file name: secret.yml")]),e._v(" "),s("ol",[s("li",[e._v("This is an ansible vault file.")])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("Default password for Ansible Vault files is changeme.")])]),e._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[e._v('Variables from "secret.yml" that are required by playbooks under "infrastructure" directory are listed here:')]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# oneview_ip: x.x.x.x ")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# oneview_username: username")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# oneview_password: password")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# oneview_api_version: 1600")]),e._v("\n")])])])])])]),e._v(" "),s("li",[s("p",[e._v("Input file name: inputs.yml")]),e._v(" "),s("ul",[s("li",[s("p",[e._v('Variables from "inputs.yml" that are required by playbooks under "infrastructure" directory are listed here:')]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# enclosure_group: <Enclosure group name as per OneView> ")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# deployment_network_name: <Deployment network name as per OneView>")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# hcpnodes_template_name: <Custom name for hcpnodes_SPT>")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# gw_template_name: <Custom name for gw_SPT>")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# fw_bundle_path: <Firmware Bundle file path>  #Comment this parameter to deploy the server profiles without firmware.")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# fw_bundle_file_name: <Firmware file name with extension>  #Comment this parameter to deploy the server profiles without firmware.")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# managefw: true  #Change this parameter to false for deploy the server profiles without firmware. ")]),e._v("\n\n")])])])])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If the firmware is already available in the composer and there is no requirement of a new firmware then the following changes need to be made:")]),e._v(" "),s("ul",[s("li",[e._v('Comment the "fw_bundle_path", "fw_bundle_file_name" parameters')]),e._v(" "),s("li",[e._v('Set the "managefw" parameter as false')])])])]),e._v(" "),s("li",[s("p",[e._v("Input file name: fw_version_inputs.yml")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("This file contains the version information of the firmware that should be updated on the server hardware. Ignore this file in the event firmware is not managed via server profile.")])]),e._v(" "),s("li",[s("p",[e._v('Variables from "fw_version_inputs.yml" that are required by playbooks under "infrastructure" directory are listed here:')]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# innovationengine: < INNOVATION_ENGINE_VERSION >")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# systemrombios: < SYSTEM_ROM_VERSION >")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# serverplatformservices: < SERVER_PLATFORM_SERVICES >")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# powermanagementcontroller: < POWER_MANAGEMENT_CONTROLLER >")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ilo5: < iLO_5_VERSION >")]),e._v("\n")])])])])])])]),e._v(" "),s("h2",{attrs:{id:"deatils-of-playbook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deatils-of-playbook"}},[e._v("#")]),e._v(" Deatils of playbook")]),e._v(" "),s("p",[s("strong",[e._v("Using firmware bundle:")])]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Execute the following command to upload the firmware bundle to OneView.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible-playbook -i hosts playbooks/upload_firmware_bundle.yml --ask-vault-pass")]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Execute the following command to create and deploy the Server Profile template along with Firmware bundle.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible-playbook -i hosts playbooks/server_profile_template_fw.yml --ask-vault-pass")]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Execute the following command to create and deploy Server Profile, update the firmware on Synergy Compute Module and validate the firmware versions.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible-playbook -i hosts playbooks/server_profile_fw.yml --ask-vault-pass")]),e._v("\n")])])])])]),e._v(" "),s("p",[s("strong",[e._v("Without using Firmware bundle:")])]),e._v(" "),s("ul",[s("li",[s("p",[e._v("Execute the following command to create and deploy the Server Profile template with managed Firmware manually.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible-playbook -i hosts playbooks/server_profile_template.yml --ask-vault-pass")]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("Synergy compute module will manage firmware manually.Using the server template, server profile will be assigned to each compute module.Execute the following command to carry out this action.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible-playbook -i hosts playbooks/server_profile_fw.yml --ask-vault-pass")]),e._v("\n")])])])])])])}),[],!1,null,null,null);t.default=r.exports}}]);