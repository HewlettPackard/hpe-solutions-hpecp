(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{444:function(t,s,e){"use strict";e.r(s);var a=e(42),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"preparing-sles-15-hosts-for-hpecp-installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#preparing-sles-15-hosts-for-hpecp-installation"}},[t._v("#")]),t._v(" Preparing SLES 15 hosts for HPECP installation")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Prerequisites")]),t._v(" "),e("p",[t._v("Centos 7 Installer machine with the following configurations is essential.")]),t._v(" "),e("ol",[e("li",[e("p",[t._v('Enable Python3 and Ansible Environment as mentioned in "'),e("RouterLink",{attrs:{to:"/Solution-Deployment/Host-Configuration.html#installer-machine"}},[t._v("Installer machine")]),t._v('" section of deployment guide.')],1)]),t._v(" "),e("li",[e("p",[t._v("Passwordless SSH is configured to target hosts from the installer machine. Steps for configuring passwordless SSH is as follows:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Execute the following command on installer machine to generate a new SSH key pair.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ssh-keygen\n")])])])]),t._v(" "),e("li",[e("p",[t._v("To generate a SSH key pair of specific algorithm or specific key size as per user requirements, use the following command.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ssh-keygen -t "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("algorithm"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" -b "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("keysize"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])])])])])]),t._v(" "),e("h2",{attrs:{id:"input-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#input-files"}},[t._v("#")]),t._v(" Input Files")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("There is one input file reg_detail.yaml which needs to be updated with values for all the variables present within them.")])]),t._v(" "),e("li",[e("p",[t._v('Open reg_detail.yaml present in "BASE_DIR/prepare_hpecp_hosts" folder with the following command and enter the details listed below.')]),t._v(" "),e("p",[t._v("Command to edit reg_details.yaml")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ansible-vault edit reg_details.yaml\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v('Default password for Ansible Vault file reg_details.yaml is "changeme".')])]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Mode : There are two modes of server registration, RMT and User Email. Permissible values are 1 (For registering the SUSE server to RMT) and 2 (For registering the SUSE server using Email)")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Mode 1 : Registration using RMT server.\n(Update the reg_details.yaml with the following inputs)")]),t._v(" "),e("ul",[e("li",[t._v("RMT_URL: RMT server ip address.")])])]),t._v(" "),e("li",[e("p",[t._v("Mode 2 : Registration using User Email Id and RegCode\n(Update the reg_details.yaml with the following inputs)")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Email :- User Email-id which will be used for server registration.")])]),t._v(" "),e("li",[e("p",[t._v("base_code :- Registration code which will be used for server registration.")])]),t._v(" "),e("li",[e("p",[t._v("caas_code :- Registration code for caas module.")])]),t._v(" "),e("li",[e("p",[t._v("ha_code:- Registration code for ha module.")])])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("Email and Reg_codes are applicable only for Mode 2 else leave blank.")])])]),t._v(" "),e("li",[e("p",[t._v("sles_packages : sles modules which will be installed separated by comma.")])]),t._v(" "),e("li",[e("p",[t._v("Zypper_packages : zypper packages which will be installed separated by comma.")])])])]),t._v(" "),e("li",[e("p",[t._v("Example values for the reg_details.yaml is as follows.")])])]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Mode 1 for RMT Registration and Mode 2 for User Registration")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Mode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Email")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jim."),e("span",{pre:!0,attrs:{class:"token important"}},[t._v("***@***.com")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("base_code")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 8BAB9EC"),e("span",{pre:!0,attrs:{class:"token important"}},[t._v("****")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("caas_code")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 21E02"),e("span",{pre:!0,attrs:{class:"token important"}},[t._v("******")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ha_code")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 87D73"),e("span",{pre:!0,attrs:{class:"token important"}},[t._v("*****")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("RMT_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//20."),e("span",{pre:!0,attrs:{class:"token important"}},[t._v("**.**.**")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sles_packages")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("public"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cloud/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("legacy/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("python2/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("containers/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("basesystem/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("desktop"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("applications/15.1/x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("zypper_packages")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("iputils"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("bind"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("utils"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("autofs"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("libcgroup1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("kernel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("default"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("devel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("gcc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("c++"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("perl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pciutils"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rsyslog"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("firewalld"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("Don't modify the sles_packages and zypper_packages as these packages are required for HPECP implementation. Any changes made to this section may impact the installation.")])]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("ol",[e("li",[e("p",[t._v('Enable Python3 and Ansible Environment as mentioned in "Installer machine" section of deployment guide.')])]),t._v(" "),e("li",[e("p",[t._v('Change the current working directory to "prepare_hpecp_hosts" using the following command')]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" BASE_DIR/prepare_hpecp_hosts\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v('BASE_DIR is defined and set in "Installer machine" section in deployment guide.')])])]),t._v(" "),e("li",[e("p",[t._v("Execute the copy.sh script to copy the ssh keys to the SLES hosts.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" copy.sh\n")])])]),e("ul",[e("li",[t._v("User Needs to enter the sles hosts password at the prompt.")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("ul",[e("li",[t._v("By default the forks parameter in Ansible is limited to 5. Update the Ansible configuration to increase the value to number of hosts that are getting configured using this playbook by executing the following command."),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ANSIBLE_FORKS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("number_of_hosts_present_in_the_ansible_inventory_file"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])])])])]),t._v(" "),e("li",[e("p",[t._v("Execute the playbook using the following command.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" ansible-playbook -i inventory prepare_host.yml --ask-vault-pass\n")])])])])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("The inventory file is being generated during the OS deployment script execution based on the inputs provided in server_detail.json. In case the prepare host script needs to be executed on other servers, the inventory file present in BASE_DIR/prepare_hpecp_hosts can be updated manually with the corrosponding server details.")])]),t._v(" "),e("li",[e("p",[t._v("During the playbook execution, while installing the packageHub Module it might throw an error in the first attempt. This is a known issue from SUSE and is being taken care by re-installing the module.\nLink for reference "),e("a",{attrs:{href:"https://www.suse.com/support/kb/doc/?id=000019505",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.suse.com/support/kb/doc/?id=000019505"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[t._v("In case the script fails while checking the internet connection from the hosts, kindly cross verify the internet from the hosts and then re-run the script.")])]),t._v(" "),e("li",[e("p",[t._v("While checking the AppArmor service the error is expected as it verifies the AppArmor service status on the hosts and if it is running, it will stop and disable the same.")])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);