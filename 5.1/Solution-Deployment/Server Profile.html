<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Server Profile Overview | HPE EZMERAL CONTAINER PLATFORM 5.1 AND HPE EZMERAL DATA FABRIC ON HPE SYNERGY AND HPE APOLLO 4200 GEN10 SERVERS</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/css/0.styles.ad965169.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/app.ef59d087.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/2.d85522de.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/19.de5eb1f0.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/10.06af00e2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/11.b5cb4c34.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/12.a84126ed.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/13.0680d9b2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/14.795ea125.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/15.33cac8ca.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/16.88e99b7e.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/17.e57d4413.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/18.f9325bb2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/20.be5877b8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/21.01285221.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/22.4f2e2874.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/23.22cda737.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/24.a2a5f581.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/3.2cb330c1.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/4.e3f72e24.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/5.a6146132.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/6.062d4e39.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/7.8414efd9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/8.41db8db4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/9.164e8e89.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.1/assets/css/0.styles.ad965169.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.1/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL CONTAINER PLATFORM 5.1 AND HPE EZMERAL DATA FABRIC ON HPE SYNERGY AND HPE APOLLO 4200 GEN10 SERVERS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE Ezmeral Container Platform 5.1</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Solution Deployment Flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Host configuration</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Server Profile.html" class="active sidebar-link">Server Profile Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Server Profile.html#software-requirements" class="sidebar-link">Software requirements</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Server Profile.html#usage" class="sidebar-link">Usage</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Server Profile.html#deatils-of-playbook" class="sidebar-link">Deatils of playbook</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Operating System Deployment.html" class="sidebar-link">Deploying operating system on bare-metal nodes</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Preparing Hosts.html" class="sidebar-link">Preparing SLES 15 hosts for HPECP installation</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Automated HPECP Deployment.html" class="sidebar-link">Deploying HPE Ezmeral Container Platform using Ansible playbook</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Manual HPECP Deployment.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Container Platform 5.1</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Securing HPECP.html" class="sidebar-link">Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources and additional links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="server-profile-overview"><a href="#server-profile-overview" class="header-anchor">#</a> Server Profile Overview</h1> <p>This section consists of an overview about the server profile automation done and the ansible playbooks developed to automate the tasks such as uploading firmware baseline iso package to OneView, creating server profile template &amp; server profiles in HPE OneView.</p> <div class="custom-block warning"><p class="custom-block-title">Prerequisites</p> <ul><li><p>Ansible engine with Ansible 2.9.x and Python 3.6.x</p></li> <li><p><strong>Python module for HPE OneView</strong>: hpOneView is the Python SDK for the OneView API that allows you to manage OneView functionalities. Download the python repository at <a href="https://github.com/HewlettPackard/oneview-python" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/oneview-python<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><strong>Ansible module for HPE OneView</strong>: OneView-ansible is the Ansible Module for HPE OneView which utilizes the python SDK to enable infrastructure as a code. Download the repository at <a href="https://github.com/HewlettPackard/oneview-ansible/" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/oneview-ansible/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><strong>Ansible configuration file</strong>: By default,the <strong>forks</strong> parameter in <strong>Ansible</strong> is limited to 5, please increase the value to number of hosts that are getting configured using this playbook.</p></li></ul></div> <p>Flow Diagram 2 shows the high level flow of the server profile automation.</p> <p><img src="/hpe-solutions-hpecp/5.1/assets/img/Flow2.627b02f0.png" alt=""></p> <p><strong>Flow Diagram 2.</strong> Workflow diagram for automated Server Profile deployment</p> <h2 id="software-requirements"><a href="#software-requirements" class="header-anchor">#</a> Software requirements</h2> <table><thead><tr><th>Software</th> <th>Version</th></tr></thead> <tbody><tr><td>HPE OneView</td> <td>5.2</td></tr> <tr><td>CentOS</td> <td>7.6</td></tr></tbody></table> <h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <ul><li>Execute the following command to switch to infrastructure directory.<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> BASE_DIR/infrastructure
</code></pre></div></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <ol><li>BASE_DIR is defined and set in <a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html#installer-machine">Installer machine</a> section in deployment guide.</li> <li>Enable Python3 and Ansible Environment as mentioned in <a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html#installer-machine">Installer machine</a> section of deployment guide.</li> <li>Run <code>which python3</code> command to get the ansible_python interpreter value. Assign this value to ansible_python_interpreter variable in input.yml.</li></ol></div> <ul><li><p>It is mandatory to update all the input files (inputs.yml, hosts, secret.yml, fw_version_inputs.yml) with appropriate values before running any playbooks available in this repository.</p></li> <li><p>Update the inventory(hosts), ansible vault(secret.yml), variable file(input.yml) and firmware version variable file (fw_version_inputs.yml) with the appropriate values.</p></li> <li><p>Input file name: hosts</p> <ol><li><p>This file is an inventory of host details.</p></li> <li><p>Variables from &quot;hosts&quot; that are required by playbooks under &quot;infrastructure&quot; directory are listed here:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># [server_profile_template] </span>
<span class="token comment"># [server_profile]</span>
</code></pre></div></li></ol></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <ul><li><p>It's recommended to use the same server type (ex:type=&quot;SY 480 Gen10 1&quot;,type=&quot;SY 480 Gen10 2&quot;,..) for server profile template and assign the same server type to the server profile.</p></li> <li><p>To use multiple server types, create server profile template for each server type and assign it to the same server type to server profile.</p></li></ul></div> <ul><li><p>Input file name: secret.yml</p> <ol><li>This is an ansible vault file.</li></ol> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Default password for Ansible Vault files is changeme.</p></div> <ol start="2"><li><p>Variables from &quot;secret.yml&quot; that are required by playbooks under &quot;infrastructure&quot; directory are listed here:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># oneview_ip: x.x.x.x </span>

<span class="token comment"># oneview_username: username</span>

<span class="token comment"># oneview_password: password</span>

<span class="token comment"># oneview_api_version: 1600</span>
</code></pre></div></li></ol></li> <li><p>Input file name: inputs.yml</p> <ul><li><p>Variables from &quot;inputs.yml&quot; that are required by playbooks under &quot;infrastructure&quot; directory are listed here:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># enclosure_group: &lt;Enclosure group name as per OneView&gt; </span>

<span class="token comment"># deployment_network_name: &lt;Deployment network name as per OneView&gt;</span>

<span class="token comment"># hcpnodes_template_name: &lt;Custom name for hcpnodes_SPT&gt;</span>

<span class="token comment"># gw_template_name: &lt;Custom name for gw_SPT&gt;</span>

<span class="token comment"># fw_bundle_path: &lt;Firmware Bundle file path&gt;  #Comment this parameter to deploy the server profiles without firmware.</span>

<span class="token comment"># fw_bundle_file_name: &lt;Firmware file name with extension&gt;  #Comment this parameter to deploy the server profiles without firmware.</span>

<span class="token comment"># managefw: true  #Change this parameter to false for deploy the server profiles without firmware. </span>

</code></pre></div></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>If the firmware is already available in the composer and there is no requirement of a new firmware then the following changes need to be made:</p> <ul><li>Comment the &quot;fw_bundle_path&quot;, &quot;fw_bundle_file_name&quot; parameters</li> <li>Set the &quot;managefw&quot; parameter as false</li></ul></div></li> <li><p>Input file name: fw_version_inputs.yml</p> <ol><li><p>This file contains the version information of the firmware that should be updated on the server hardware. Ignore this file in the event firmware is not managed via server profile.</p></li> <li><p>Variables from &quot;fw_version_inputs.yml&quot; that are required by playbooks under &quot;infrastructure&quot; directory are listed here:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># innovationengine: &lt; INNOVATION_ENGINE_VERSION &gt;</span>

<span class="token comment"># systemrombios: &lt; SYSTEM_ROM_VERSION &gt;</span>

<span class="token comment"># serverplatformservices: &lt; SERVER_PLATFORM_SERVICES &gt;</span>

<span class="token comment"># powermanagementcontroller: &lt; POWER_MANAGEMENT_CONTROLLER &gt;</span>

<span class="token comment"># ilo5: &lt; iLO_5_VERSION &gt;</span>
</code></pre></div></li></ol></li></ul> <h2 id="deatils-of-playbook"><a href="#deatils-of-playbook" class="header-anchor">#</a> Deatils of playbook</h2> <p><strong>Using firmware bundle:</strong></p> <ul><li><p>Execute the following command to upload the firmware bundle to OneView.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ansible-playbook -i hosts playbooks/upload_firmware_bundle.yml --ask-vault-pass</span>
</code></pre></div></li> <li><p>Execute the following command to create and deploy the Server Profile template along with Firmware bundle.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ansible-playbook -i hosts playbooks/server_profile_template_fw.yml --ask-vault-pass</span>
</code></pre></div></li> <li><p>Execute the following command to create and deploy Server Profile, update the firmware on Synergy Compute Module and validate the firmware versions.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ansible-playbook -i hosts playbooks/server_profile_fw.yml --ask-vault-pass</span>
</code></pre></div></li></ul> <p><strong>Without using Firmware bundle:</strong></p> <ul><li><p>Execute the following command to create and deploy the Server Profile template with managed Firmware manually.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ansible-playbook -i hosts playbooks/server_profile_template.yml --ask-vault-pass</span>
</code></pre></div></li> <li><p>Synergy compute module will manage firmware manually.Using the server template, server profile will be assigned to each compute module.Execute the following command to carry out this action.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ansible-playbook -i hosts playbooks/server_profile_fw.yml --ask-vault-pass</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html" class="prev">
        Host configuration
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Operating System Deployment.html">
        Deploying operating system on bare-metal nodes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.1/assets/js/app.ef59d087.js" defer></script><script src="/hpe-solutions-hpecp/5.1/assets/js/2.d85522de.js" defer></script><script src="/hpe-solutions-hpecp/5.1/assets/js/19.de5eb1f0.js" defer></script>
  </body>
</html>
