<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Preparing SLES 15 hosts for HPECP installation | HPE EZMERAL CONTAINER PLATFORM 5.1 AND HPE EZMERAL DATA FABRIC ON HPE SYNERGY AND HPE APOLLO 4200 GEN10 SERVERS</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/css/0.styles.ad965169.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/app.80209f87.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/2.d85522de.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.1/assets/js/24.a2a5f581.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/10.06af00e2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/11.a874e0d9.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/12.8d5874ac.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/13.ff9fcf0f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/14.e515529c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/15.99dc2c1d.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/16.716ce1b3.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/17.e57d4413.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/18.f9325bb2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/19.3788861e.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/20.05b8bb97.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/21.01285221.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/22.a5d4f965.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/23.f8772e9c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/3.97cff34c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/4.cd784f77.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/5.aed540b7.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/6.b85c7d7e.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/7.e2062dcf.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/8.41db8db4.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.1/assets/js/9.a10e97eb.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.1/assets/css/0.styles.ad965169.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.1/" class="home-link router-link-active"><!----> <span class="site-name">HPE EZMERAL CONTAINER PLATFORM 5.1 AND HPE EZMERAL DATA FABRIC ON HPE SYNERGY AND HPE APOLLO 4200 GEN10 SERVERS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HPE Ezmeral Container Platform 5.1</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Solution Deployment Flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html" class="sidebar-link">Host configuration</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Server Profile.html" class="sidebar-link">Server Profile Overview</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Operating System Deployment.html" class="sidebar-link">Deploying operating system on bare-metal nodes</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Preparing Hosts.html" class="active sidebar-link">Preparing SLES 15 hosts for HPECP installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Preparing Hosts.html#input-files" class="sidebar-link">Input Files</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Preparing Hosts.html#installation" class="sidebar-link">Installation</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Automated HPECP Deployment.html" class="sidebar-link">Deploying HPE Ezmeral Container Platform using Ansible playbook</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Manual HPECP Deployment.html" class="sidebar-link">Manually Install and configure HPE Ezmeral Container Platform 5.1</a></li><li><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Securing HPECP.html" class="sidebar-link">Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources and additional links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="preparing-sles-15-hosts-for-hpecp-installation"><a href="#preparing-sles-15-hosts-for-hpecp-installation" class="header-anchor">#</a> Preparing SLES 15 hosts for HPECP installation</h1> <div class="custom-block warning"><p class="custom-block-title">Prerequisites</p> <p>Centos 7 Installer machine with the following configurations is essential.</p> <ol><li><p>Enable Python3 and Ansible Environment as mentioned in &quot;<a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Host-Configuration.html#installer-machine">Installer machine</a>&quot; section of deployment guide.</p></li> <li><p>Passwordless SSH is configured to target hosts from the installer machine. Steps for configuring passwordless SSH is as follows:</p> <ul><li><p>Execute the following command on installer machine to generate a new SSH key pair.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ssh-keygen
</code></pre></div></li> <li><p>To generate a SSH key pair of specific algorithm or specific key size as per user requirements, use the following command.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ssh-keygen -t <span class="token operator">&lt;</span>algorithm<span class="token operator">&gt;</span> -b <span class="token operator">&lt;</span>keysize<span class="token operator">&gt;</span>
</code></pre></div></li></ul></li></ol></div> <h2 id="input-files"><a href="#input-files" class="header-anchor">#</a> Input Files</h2> <ul><li><p>There is one input file reg_detail.yaml which needs to be updated with values for all the variables present within them.</p></li> <li><p>Open reg_detail.yaml present in &quot;BASE_DIR/prepare_hpecp_hosts&quot; folder with the following command and enter the details listed below.</p> <p>Command to edit reg_details.yaml</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit reg_details.yaml
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Default password for Ansible Vault file reg_details.yaml is &quot;changeme&quot;.</p></div> <ol><li><p>Mode : There are two modes of server registration, RMT and User Email. Permissible values are 1 (For registering the SUSE server to RMT) and 2 (For registering the SUSE server using Email)</p> <ul><li><p>Mode 1 : Registration using RMT server.
(Update the reg_details.yaml with the following inputs)</p> <ul><li>RMT_URL: RMT server ip address.</li></ul></li> <li><p>Mode 2 : Registration using User Email Id and RegCode
(Update the reg_details.yaml with the following inputs)</p> <ul><li><p>Email :- User Email-id which will be used for server registration.</p></li> <li><p>base_code :- Registration code which will be used for server registration.</p></li> <li><p>caas_code :- Registration code for caas module.</p></li> <li><p>ha_code:- Registration code for ha module.</p></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Email and Reg_codes are applicable only for Mode 2 else leave blank.</p></div></li> <li><p>sles_packages : sles modules which will be installed separated by comma.</p></li> <li><p>Zypper_packages : zypper packages which will be installed separated by comma.</p></li></ol></li> <li><p>Example values for the reg_details.yaml is as follows.</p></li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token punctuation">---</span>

<span class="token comment">#Mode 1 for RMT Registration and Mode 2 for User Registration</span>

<span class="token key atrule">Mode</span><span class="token punctuation">:</span> <span class="token number">2</span>

<span class="token key atrule">Email</span><span class="token punctuation">:</span> jim.<span class="token important">***@***.com</span>
<span class="token key atrule">base_code</span><span class="token punctuation">:</span> 8BAB9EC<span class="token important">****</span>
<span class="token key atrule">caas_code</span><span class="token punctuation">:</span> 21E02<span class="token important">******</span>
<span class="token key atrule">ha_code</span><span class="token punctuation">:</span> 87D73<span class="token important">*****</span>

<span class="token key atrule">RMT_URL</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//20.<span class="token important">**.**.**</span>

<span class="token key atrule">sles_packages</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>public<span class="token punctuation">-</span>cloud/15.1/x86_64<span class="token punctuation">,</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>legacy/15.1/x86_64<span class="token punctuation">,</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>python2/15.1/x86_64<span class="token punctuation">,</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>containers/15.1/x86_64<span class="token punctuation">,</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>basesystem/15.1/x86_64<span class="token punctuation">,</span>sle<span class="token punctuation">-</span>module<span class="token punctuation">-</span>desktop<span class="token punctuation">-</span>applications/15.1/x86_64<span class="token punctuation">]</span>

<span class="token key atrule">zypper_packages</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>iputils<span class="token punctuation">,</span>bind<span class="token punctuation">-</span>utils<span class="token punctuation">,</span>autofs<span class="token punctuation">,</span>libcgroup1<span class="token punctuation">,</span>kernel<span class="token punctuation">-</span>default<span class="token punctuation">-</span>devel<span class="token punctuation">,</span>gcc<span class="token punctuation">-</span>c++<span class="token punctuation">,</span>perl<span class="token punctuation">,</span>pciutils<span class="token punctuation">,</span>rsyslog<span class="token punctuation">,</span>firewalld<span class="token punctuation">]</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Don't modify the sles_packages and zypper_packages as these packages are required for HPECP implementation. Any changes made to this section may impact the installation.</p></div> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <ol><li><p>Enable Python3 and Ansible Environment as mentioned in &quot;Installer machine&quot; section of deployment guide.</p></li> <li><p>Change the current working directory to &quot;prepare_hpecp_hosts&quot; using the following command</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> BASE_DIR/prepare_hpecp_hosts
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>BASE_DIR is defined and set in &quot;Installer machine&quot; section in deployment guide.</p></div></li> <li><p>Execute the copy.sh script to copy the ssh keys to the SLES hosts.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">sh</span> copy.sh
</code></pre></div><ul><li>User Needs to enter the sles hosts password at the prompt.</li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <ul><li>By default the forks parameter in Ansible is limited to 5. Update the Ansible configuration to increase the value to number of hosts that are getting configured using this playbook by executing the following command.<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable">ANSIBLE_FORKS</span><span class="token operator">=</span><span class="token operator">&lt;</span>number_of_hosts_present_in_the_ansible_inventory_file<span class="token operator">&gt;</span>
</code></pre></div></li></ul></div></li> <li><p>Execute the playbook using the following command.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook -i inventory prepare_host.yml --ask-vault-pass
</code></pre></div></li></ol> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <ul><li><p>The inventory file is being generated during the OS deployment script execution based on the inputs provided in server_detail.json. In case the prepare host script needs to be executed on other servers, the inventory file present in BASE_DIR/prepare_hpecp_hosts can be updated manually with the corrosponding server details.</p></li> <li><p>During the playbook execution, while installing the packageHub Module it might throw an error in the first attempt. This is a known issue from SUSE and is being taken care by re-installing the module.
Link for reference <a href="https://www.suse.com/support/kb/doc/?id=000019505" target="_blank" rel="noopener noreferrer">https://www.suse.com/support/kb/doc/?id=000019505<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>In case the script fails while checking the internet connection from the hosts, kindly cross verify the internet from the hosts and then re-run the script.</p></li> <li><p>While checking the AppArmor service the error is expected as it verifies the AppArmor service status on the hosts and if it is running, it will stop and disable the same.</p></li></ul></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Operating System Deployment.html" class="prev">
        Deploying operating system on bare-metal nodes
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.1/Solution-Deployment/Automated HPECP Deployment.html">
        Deploying HPE Ezmeral Container Platform using Ansible playbook
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.1/assets/js/app.80209f87.js" defer></script><script src="/hpe-solutions-hpecp/5.1/assets/js/2.d85522de.js" defer></script><script src="/hpe-solutions-hpecp/5.1/assets/js/24.a2a5f581.js" defer></script>
  </body>
</html>
