<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor | HPE Deployment Guide for HPE Ezmeral Container Platform on HPE Synergy </title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/css/0.styles.d5074086.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/app.9e57fa5b.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/2.ca577d1f.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/8.9c411008.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/10.7653ac4a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/11.03b59ef5.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/12.4053d4ed.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/13.10e37ced.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/14.6593624f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/15.abd6c11c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/16.4724e478.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/17.cc499619.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/18.55c184dc.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/19.d4c727d2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/3.11053c91.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/4.c1ef1af0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/5.b9f3fa98.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/6.84dca2fa.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/7.044c1ac8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/9.047e217f.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.0/assets/css/0.styles.d5074086.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.0/" class="home-link router-link-active"><!----> <span class="site-name">HPE Deployment Guide for HPE Ezmeral Container Platform on HPE Synergy </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.0/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.0/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/hpe-solutions-hpecp/5.0/Introduction/Introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/hpe-solutions-hpecp/5.0/Solution overview/Solution overview.html" class="sidebar-link">Solution overview</a></li><li><a href="/hpe-solutions-hpecp/5.0/Solution components/Solution components.html" class="sidebar-link">Solution components</a></li><li><a href="/hpe-solutions-hpecp/5.0/Physical environment configuration/Physical environment configuration.html" class="sidebar-link">Physical environment configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Worker-node-configuration/Worker-node-configuration.html" class="sidebar-link">Worker node configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploy HPE Ezmeral Container Platform/Deploy HPE Ezmeral Container Platform.html" class="sidebar-link">Deploy HPE Ezmeral Container Platform</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploying Kubernetes cluster/Deploying Kubernetes cluster.html" class="sidebar-link">Deploying Kubernetes cluster</a></li><li><a href="/hpe-solutions-hpecp/5.0/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor.html" class="active sidebar-link">Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.0/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor.html#playbooks-for-configuring-sysdig-for-hpe-ezmeral-container-platform" class="sidebar-link">Playbooks for configuring Sysdig for HPE Ezmeral Container Platform</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.0/Validate HPE Ezmeral Container Platform deployment/Validate HPE Ezmeral Container Platform deployment.html" class="sidebar-link">Validate HPE Ezmeral Container Platform deployment</a></li><li><a href="/hpe-solutions-hpecp/5.0/HPE CSI driver installation/HPE CSI driver installation.html" class="sidebar-link">HPE CSI driver installation</a></li><li><a href="/hpe-solutions-hpecp/5.0/Configuration/Configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploying WordPress application using Nimble persistent volume/Deploying WordPress application using Nimble persistent volume.html" class="sidebar-link">Deploying WordPress application using Nimble persistent volume</a></li><li><a href="/hpe-solutions-hpecp/5.0/Resources and additional links/Resources and additional links.html" class="sidebar-link">Resources and additional links</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="securing-hpe-ezmeral-container-platform-using-sysdig-secure-and-sysdig-monitor"><a href="#securing-hpe-ezmeral-container-platform-using-sysdig-secure-and-sysdig-monitor" class="header-anchor">#</a> Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor</h1> <p>To address the security challenges that exist in containerized environments, this solution leverages the Sysdig SaaS Platform to secure and monitor the HPE Ezmeral Container Platform, an enterprise-ready Kubernetes platform that is installed and configured on HPE Synergy Composable Infrastructure. After the HPE Ezmeral Container Platform Kubernetes cluster is deployed, cluster access is granted to the Sysdig SaaS Platform. The Sysdig SaaS Platform is a cloud-based service where the security and monitoring services will be available to the user based on the choice of subscription. For security and monitoring of HPE Ezmeral Container Platform containers, it is required to install the Sysdig Agent on the Kubernetes cluster. This means Sysdig Agents that are lightweight entities will be installed within each node in the HPE Ezmeral Container Platform Kubernetes cluster. These agents run as a daemon to enable Sysdig Monitor and Sysdig Secure functionality.</p> <p>Sysdig Monitor provides deep, process-level visibility into dynamic, distributed production environment. Sysdig Secure provides image scanning, run-time protection, and forensics to identify vulnerabilities, block threats, enforce compliance, and audit activity across the Kubernetes cluster.</p> <p>The key security benefits are:</p> <ul><li><p>Faster incident resolution using Sysdig Monitor for the cluster.</p></li> <li><p>Simplified compliance for the entire solution.</p></li> <li><p>Service-based access control for container security and monitoring.</p></li> <li><p>Less time spent on managing platforms, containers, and vulnerabilities.</p></li></ul> <p>The implementation of Sysdig in this solution uses the Software as a Service (SaaS) deployment method. The playbooks deploy Sysdig Agent software to capture the data from every node in the HPE Ezmeral Container Platform Kubernetes deployment and the captured data is relayed back to your Sysdig SaaS Cloud portal. The deployment provides access to a 90-day try-and-buy, fully featured version of the Sysdig software. For more information about Sysdig agent deployment, see the HPE solutions for the HPE Ezmeral Container Platform GitHub at <a href="https://github.com/HewlettPackard/hpe-solutions-hpecp" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/hpe-solutions-hpecp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="playbooks-for-configuring-sysdig-for-hpe-ezmeral-container-platform"><a href="#playbooks-for-configuring-sysdig-for-hpe-ezmeral-container-platform" class="header-anchor">#</a> Playbooks for configuring Sysdig for HPE Ezmeral Container Platform</h2> <p>To install the Sysdig agents in an automated way, use the repository located at <a href="https://github.com/HewlettPackard/hpe-solutions-hpecp" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/hpe-solutions-hpecp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. The folder scripts/security/sysdig within this repository contains the following:</p> <ul><li><p><strong>Playbooks:</strong> This folder contains the playbooks required for Sysdig agent installation.</p></li> <li><p><strong>Roles:</strong> This folder contains a role called &quot;sysdig-agent-deploy-hpecp&quot; which is responsible for performing the actions required for Sysdig agent integration.</p></li> <li><p><strong>Hosts:</strong> This is the inventory file that will be used by the installer VM to reference hosts during Sysdig agent deployment. Provide the installer VM or the server which can access the Kubernetes cluster.</p></li></ul> <div class="custom-block warning"><p class="custom-block-title">Prerequisites</p> <p>To successfully deploy Sysdig agents on the nodes, the following prerequisites must be met:</p> <ul><li><p>HPE Ezmeral Container Platform Kubernetes cluster is up and running.</p></li> <li><p>The installation user has SaaS-based access to Sysdig Secure and Sysdig Monitor for the purpose of container security.</p></li> <li><p>The installation user has admin privileges for Sysdig Secure and Sysdig Monitor.</p></li> <li><p>Sysdig agents with version 9.5.0 are deployed on HPE Ezmeral Container Platform.</p></li> <li><p>The installation user has a valid access token that is given by Sysdig and is specific to their credentials on Sysdig Monitor and Sysdig Secure.</p></li></ul></div> <h3 id="custom-attributes-or-variable-files-and-plays"><a href="#custom-attributes-or-variable-files-and-plays" class="header-anchor">#</a> Custom attributes or variable files and plays</h3> <p>Each playbook has a role associated with it. Each role has a set of tasks under the &quot;<em>task</em>&quot; folder and variables under the &quot;<em>var</em>&quot; folder. These variable values must be defined by the installation user according to the installation environment before running the plays:</p> <ul><li><p><strong>roles/sysdig-agent-deploy-hpecp/vars/main.yml</strong>: Used during Sysdig agent deployment to HPE Ezmeral Container Platform Kubernetes cluster. This file contains Sysdig-related variables.</p></li> <li><p><strong>sysdig-agent-deploy-hpecp/tasks/main.yml</strong>: This file contains the actual Sysdig agent installation steps.</p></li> <li><p><strong>sysdig-agent-deploy-hpecp/files/sysdig-agent-configmap.yaml</strong>: This file is provided by Sysdig and handles the Sysdig software related configuration.</p></li> <li><p><strong>roles/sysdig-agent-deploy-hpecp/files/sysdig-agent-daemonset-v2.yaml</strong>: This file is provided by Sysdig and handles the Sysdig daemon related configuration.</p></li></ul> <p></p> <h3 id="executing-the-playbooks"><a href="#executing-the-playbooks" class="header-anchor">#</a> Executing the playbooks</h3> <p>This section describes the steps that need to be performed to use the playbooks:</p> <ol><li><p>Login to the installer VM.</p></li> <li><p>Browse the cloned directory and navigate to the following sub-directory.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> BASE_DIR/security/sysdig 
</code></pre></div></blockquote> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>BASE_DIR is defined and set in Installer machine section within this document.</p></div></li> <li><p>Update the variables in the following files.</p> <ul><li><p>Provide the Installer VM or the server which has access to the HPE Ezmeral Container Platform Kubernetes cluster [master].</p></li> <li><p>Edit the file <em>/roles/sysdig-agent-deploy-hpecp/vars/main.yml</em>.</p> <ul><li><p>Provide a value for the namespace for the Sysdig integration with HPE Ezmeral Container Platform under the &quot;namespace&quot; variable.</p></li> <li><p>Provide the Sysdig access key or token value. This value is retrieved from the user setting by logging into Sysdig Secure or Sysdig Monitor GUI in &quot;accesskeyval&quot; variable.</p></li></ul></li> <li><p>Edit the file <em>/roles/sysdig-agent-deploy-hpecp/files/sysdig-agent-configmap.yaml</em>.</p> <ul><li><p>Enter the Sysdig Collector address and port. Check with Sysdig about which collector is accessible in the installation environment and over which port.</p></li> <li><p>Hewlett Packard Enterprise recommends access of Sysdig collector over Secure Socket Layer (SSL) port. For both the &quot;ssl&quot; and &quot;ssl certificate validate&quot; keys, set the value as &quot;true&quot;.</p></li> <li><p>Set the variable related to the underlying Kubernetes deployment to true.</p></li> <li><p>Enter the cluster name of the Kubernetes cluster.</p></li></ul></li></ul></li> <li><p>Run the play using following command.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-playbook -i hosts playbooks/sysdig-agent-deployment.yaml
</code></pre></div></blockquote></li> <li><p>To verify the deployment, login to the server which has access to the Kubernetes cluster and execute the following command.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl get all -n sysdig-agent
</code></pre></div></blockquote> <p>The output of this command displays the Sysdig agent names running on each of the nodes within the HPE Ezmeral Container Platform Kubernetes cluster. If you see a pod with a pending status, then there might be a possibility that the underlying HPE Ezmeral Container Platform worker node is not functional.</p> <p>Figure 29 depicts the Sysdig agents running on HPE Ezmeral Container Platform Kubernetes nodes.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure29.22b579fd.png" alt=" "></p></li></ol> <p><strong>Figure</strong> <strong>29.</strong> Sysdig agents running on Kubernetes nodes</p> <ol start="6"><li><p>Login to Sysdig Secure web interface at <a href="https://sysdig.com/" target="_blank" rel="noopener noreferrer">https://sysdig.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as a user with administrative privileges.</p></li> <li><p>From the Sysdig Secure web interface, click the icon named <strong>POLICY EVENTS</strong> and you will see the web interface for <strong>Policy Events</strong> tab. On the <strong>Policy Events</strong> tab, click the <strong>Groupings</strong> drop-down list and select <strong>Entire Infrastructure</strong>. The user with administrative privileges should be able to see all the cluster nodes.</p> <p>Figure 30 depicts the HPE Ezmeral Container Platform Kubernetes cluster in Sysdig Secure.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure30.0a5ba997.png" alt=""></p></li></ol> <p><strong>Figure</strong> <strong>30.</strong> HPE Ezmeral Container Platform Kubernetes cluster in Sysdig Secure</p> <ol start="8"><li><p>From the Sysdig Monitor web interface, click <strong>Explore</strong> icon and you will see the web interface for the <em>Explore</em> tab. On the <em>Explore</em> tab, click the <strong>Data Source</strong>(two rectangles) drop-down menu and select the data source named <em>Sysdig Agents</em> from the drop-down list.</p></li> <li><p>Open the <strong>Groupings</strong> drop-down list and select <strong>Clusters and Nodes</strong>. The user with administrative privileges should be able to see all the HPE Container Platform Kubernetes nodes.</p> <p>Figure 31 depicts the HPE Ezmeral Container Platform Kubernetes cluster in Sysdig Monitor.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure31.a8022597.png" alt=""></p> <p><strong>Figure</strong> <strong>31.</strong> HPE Ezmeral Container Platform Kubernetes cluster in Sysdig Monitor</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>For an explanation of host requirements for agent installation, see <a href="https://docs.sysdig.com/en/host-requirements-for-agent-installation.html" target="_blank" rel="noopener noreferrer">https://docs.sysdig.com/en/host-requirements-for-agent-installation.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>It is recommended to use port 6443 to transfer data over Secure Socket Layer/ Transport Layer Security (SSL/TLS) protocol. Sysdig agents transfer data to Sysdig Cloud over HTTPS that encrypts and decrypts the requests and the responses returned by the Sysdig Cloud.</p></div></li> <li><p>From the Sysdig Monitor web interface, click the <strong>EXPLORE</strong> icon. On the <em>Explore</em> tab, click the <strong>Data Source</strong>(two rectangles) drop-down menu and select the data source named <strong>Sysdig Agents</strong>from the drop-down list. Open the **Groupings **drop-down list and select <strong>Deployment and Pods</strong>. A user with administrative privileges should be able to see all the agents and their details.</p> <p>Figure 32 depicts the Sysdig agents running on HPE Ezmeral Container Platform Kubernetes cluster.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure32.236cec5f.png" alt=" "></p> <p><strong>Figure</strong> <strong>32.</strong> Sysdig agents running on HPE Container Platform Kubernetes cluster</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.0/Deploying Kubernetes cluster/Deploying Kubernetes cluster.html" class="prev">
        Deploying Kubernetes cluster
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.0/Validate HPE Ezmeral Container Platform deployment/Validate HPE Ezmeral Container Platform deployment.html">
        Validate HPE Ezmeral Container Platform deployment
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.0/assets/js/app.9e57fa5b.js" defer></script><script src="/hpe-solutions-hpecp/5.0/assets/js/2.ca577d1f.js" defer></script><script src="/hpe-solutions-hpecp/5.0/assets/js/8.9c411008.js" defer></script>
  </body>
</html>
