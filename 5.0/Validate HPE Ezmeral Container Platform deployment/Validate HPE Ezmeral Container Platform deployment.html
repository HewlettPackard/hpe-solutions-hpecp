<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Validate HPE Ezmeral Container Platform deployment | HPE Deployment Guide for HPE Ezmeral Container Platform on HPE Synergy </title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/css/0.styles.d5074086.css" as="style"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/app.9e57fa5b.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/2.ca577d1f.js" as="script"><link rel="preload" href="/hpe-solutions-hpecp/5.0/assets/js/5.b9f3fa98.js" as="script"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/10.7653ac4a.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/11.03b59ef5.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/12.4053d4ed.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/13.10e37ced.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/14.6593624f.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/15.abd6c11c.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/16.4724e478.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/17.cc499619.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/18.55c184dc.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/19.d4c727d2.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/3.11053c91.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/4.c1ef1af0.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/6.84dca2fa.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/7.044c1ac8.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/8.9c411008.js"><link rel="prefetch" href="/hpe-solutions-hpecp/5.0/assets/js/9.047e217f.js">
    <link rel="stylesheet" href="/hpe-solutions-hpecp/5.0/assets/css/0.styles.d5074086.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-hpecp/5.0/" class="home-link router-link-active"><!----> <span class="site-name">HPE Deployment Guide for HPE Ezmeral Container Platform on HPE Synergy </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.0/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-hpecp/5.0/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/hpe-solutions-hpecp/5.0/Introduction/Introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/hpe-solutions-hpecp/5.0/Solution overview/Solution overview.html" class="sidebar-link">Solution overview</a></li><li><a href="/hpe-solutions-hpecp/5.0/Solution components/Solution components.html" class="sidebar-link">Solution components</a></li><li><a href="/hpe-solutions-hpecp/5.0/Physical environment configuration/Physical environment configuration.html" class="sidebar-link">Physical environment configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Worker-node-configuration/Worker-node-configuration.html" class="sidebar-link">Worker node configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploy HPE Ezmeral Container Platform/Deploy HPE Ezmeral Container Platform.html" class="sidebar-link">Deploy HPE Ezmeral Container Platform</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploying Kubernetes cluster/Deploying Kubernetes cluster.html" class="sidebar-link">Deploying Kubernetes cluster</a></li><li><a href="/hpe-solutions-hpecp/5.0/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor.html" class="sidebar-link">Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor</a></li><li><a href="/hpe-solutions-hpecp/5.0/Validate HPE Ezmeral Container Platform deployment/Validate HPE Ezmeral Container Platform deployment.html" class="active sidebar-link">Validate HPE Ezmeral Container Platform deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-hpecp/5.0/Validate HPE Ezmeral Container Platform deployment/Validate HPE Ezmeral Container Platform deployment.html#deploying-wordpress-application-with-hpe-ezmeral-data-fabric" class="sidebar-link">Deploying WordPress application with HPE Ezmeral Data Fabric</a></li></ul></li><li><a href="/hpe-solutions-hpecp/5.0/HPE CSI driver installation/HPE CSI driver installation.html" class="sidebar-link">HPE CSI driver installation</a></li><li><a href="/hpe-solutions-hpecp/5.0/Configuration/Configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/hpe-solutions-hpecp/5.0/Deploying WordPress application using Nimble persistent volume/Deploying WordPress application using Nimble persistent volume.html" class="sidebar-link">Deploying WordPress application using Nimble persistent volume</a></li><li><a href="/hpe-solutions-hpecp/5.0/Resources and additional links/Resources and additional links.html" class="sidebar-link">Resources and additional links</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="validate-hpe-ezmeral-container-platform-deployment"><a href="#validate-hpe-ezmeral-container-platform-deployment" class="header-anchor">#</a> Validate HPE Ezmeral Container Platform deployment</h1> <p>This section deploys a sample application to validate the deployment of HPE Ezmeral Container Platform.</p> <h2 id="deploying-wordpress-application-with-hpe-ezmeral-data-fabric"><a href="#deploying-wordpress-application-with-hpe-ezmeral-data-fabric" class="header-anchor">#</a> Deploying WordPress application with HPE Ezmeral Data Fabric</h2> <p>The following example is based on <strong>WordPress and MySQL with Persistent Volume</strong> sample scenario described in <a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">kubernetes.io.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>MySQL and WordPress require a Persistent Volume to store data. Their persistent volume claim will be created at the deployment step. HPE Ezmeral Container Platform setup uses MapR as the default persistent volume.</p> <p>Add a secret generator in kustomization.yaml from the following command. You will need to replace YOUR_PASSWORD with the password you want to use.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">mkdir</span> wordpress
<span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> wordpress
<span class="token operator">&gt;</span> <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">&gt;</span>./kustomization.yaml
secretGenerator:
- name: mysql-pass
literals:
- <span class="token assign-left variable">password</span><span class="token operator">=</span>YOUR_PASSWORD
EOF
</code></pre></div></blockquote> <p>Download these two yaml manifest files for MySQL and WordPress services respectively:</p> <ul><li><p><a href="https://kubernetes.io/examples/application/wordpress/mysql-deployment.yaml" target="_blank" rel="noopener noreferrer">https://kubernetes.io/examples/application/wordpress/mysql-deployment.yaml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://kubernetes.io/examples/application/wordpress/wordpress-deployment.yaml" target="_blank" rel="noopener noreferrer">https://kubernetes.io/examples/application/wordpress/wordpress-deployment.yaml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">curl</span> -kO https://kubernetes.io/examples/application/wordpress/mysql-deployment.yaml
% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
<span class="token number">100</span> <span class="token number">1238</span> <span class="token number">100</span> <span class="token number">1238</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1430</span> <span class="token number">0</span> --:--:-- --:--:-- --:--:-- <span class="token number">1429</span>

<span class="token operator">&gt;</span> <span class="token function">curl</span> -kO https://kubernetes.io/examples/application/wordpress/wordpress-deployment.yaml
% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
<span class="token number">100</span> <span class="token number">1323</span> <span class="token number">100</span> <span class="token number">1323</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1441</span> <span class="token number">0</span> --:--:-- --:--:-- --:--:-- <span class="token number">1441</span>

<span class="token operator">&gt;</span> <span class="token function">ls</span> -al
total <span class="token number">9</span>
drwxr-xr-x <span class="token number">1</span> leedavid UsersGrp <span class="token number">0</span> Nov <span class="token number">28</span> <span class="token number">16</span>:50 <span class="token builtin class-name">.</span>
drwx------ <span class="token number">1</span> leedavid UsersGrp <span class="token number">0</span> Nov <span class="token number">28</span> <span class="token number">16</span>:46 <span class="token punctuation">..</span>
-rw-r--r-- <span class="token number">1</span> leedavid UsersGrp <span class="token number">137</span> Nov <span class="token number">28</span> <span class="token number">16</span>:49 kustomization.yaml
-rw-r--r-- <span class="token number">1</span> leedavid UsersGrp <span class="token number">1238</span> Nov <span class="token number">28</span> <span class="token number">16</span>:47 mysql-deployment.yaml
-rw-r--r-- <span class="token number">1</span> leedavid UsersGrp <span class="token number">1323</span> Nov <span class="token number">28</span> <span class="token number">16</span>:50 wordpress-deployment.yaml
</code></pre></div></blockquote> <h3 id="persistent-storage-configuration"><a href="#persistent-storage-configuration" class="header-anchor">#</a> Persistent Storage configuration</h3> <p>If you have installed HPE Ezmeral Container Platform with tenant storage, then HPE Ezmeral Container Platform will already have registered MapR as the default Storage Class in this namespace.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl get StorageClass
NAME PROVISIONER AGE
default <span class="token punctuation">(</span>default<span class="token punctuation">)</span> com.mapr.csi-kdf 39h

<span class="token operator">&gt;</span> kubectl describe StorageClass
Name: default
IsDefaultClass: Yes
Annotations: storageclass.kubernetes.io/is-default-class<span class="token operator">=</span>true
Provisioner: com.mapr.csi-kdf
Parameters: <span class="token assign-left variable">cldbHosts</span><span class="token operator">=</span><span class="token number">16.143</span>.20.131:7222,cluster<span class="token operator">=</span>epic.mapr.cluster,csi.storage.k8s.io/provisioner-secret-name<span class="token operator">=</span>mapr-user-secret,csi.s torage.k8s.io/provisioner-secret-namespace<span class="token operator">=</span>mapr-csi,csiNodePublishSecretName<span class="token operator">=</span>mapr-ticket-secret,csiNodePublishSecretNamespace<span class="token operator">=</span>mapr-csi,mountPre <span class="token assign-left variable">fix</span><span class="token operator">=</span>/mapr-csi,namePrefix<span class="token operator">=</span>k8s-1-,platinum<span class="token operator">=</span>true,restServers<span class="token operator">=</span><span class="token number">16.143</span>.20.131:8443,securityType<span class="token operator">=</span>secure
AllowVolumeExpansion: <span class="token operator">&lt;</span>unset<span class="token operator">&gt;</span>
MountOptions: <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
ReclaimPolicy: Delete
VolumeBindingMode: Immediate
Events: <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre></div></blockquote> <p>In these 2 manifest files, both WordPress service and MySQL are requesting for persistent volume (PV):</p> <h3 id="mysql-deployment"><a href="#mysql-deployment" class="header-anchor">#</a> MySQL deployment</h3> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure33.53f8c16d.png" alt=""></p> <h3 id="wordpress-deployment"><a href="#wordpress-deployment" class="header-anchor">#</a> WordPress Deployment</h3> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure34.703debf1.png" alt=""></p> <p>In both pods, there is no explicit request for specific storageClassName. Hence, it will use the default StorageClass, that is MapR storage.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure35.186844d5.png" alt=""></p> <h3 id="nodeport-service"><a href="#nodeport-service" class="header-anchor">#</a> NodePort Service</h3> <p>Edit wordpress manifest yaml to use NodePort service instead of load balancer service.</p> <p>This is needed so that HPE Ezmeral Container Platform will do port remap.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">vi</span> wordpress-deployment.yaml
<span class="token operator">&gt;</span> <span class="token function">cat</span> wordpress-deployment.yaml
apiVersion: v1
kind: Service
metadata:
name: wordpress
labels:
app: wordpress
spec:
ports:
- port: <span class="token number">80</span>
selector:
app: wordpress
tier: frontend
type: NodePort
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
name: wp-pv-claim
labels:
app: wordpress
spec:
accessModes:
- ReadWriteOnce
resources:
requests:
storage: 20Gi
---
apiVersion: apps/v1 <span class="token comment"># for versions before 1.9.0 use apps/v1beta2</span>
kind: Deployment
metadata:
name: wordpress
labels:
app: wordpress
spec:
selector:
matchLabels:
app: wordpress
tier: frontend
strategy:
type: Recreate
template:
metadata:
labels:
app: wordpress
tier: frontend
spec:
containers:
- image: wordpress:4.8-apache
name: wordpress
env:
- name: WORDPRESS_DB_HOST
value: wordpress-mysql
- name: WORDPRESS_DB_PASSWORD
valueFrom:
secretKeyRef:
name: mysql-pass
key: password
ports:
- containerPort: <span class="token number">80</span>
name: wordpress
volumeMounts:
- name: wordpress-persistent-storage
mountPath: /var/www/html
volumes:
- name: wordpress-persistent-storage
persistentVolumeClaim:
claimName: wp-pv-claim
</code></pre></div></blockquote> <h3 id="deploy-the-services"><a href="#deploy-the-services" class="header-anchor">#</a> Deploy the services</h3> <p>Add these two deployment manifests to kustomization.yaml file.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">&gt;&gt;</span>./kustomization.yaml
resources:
- mysql-deployment.yaml
- wordpress-deployment.yaml
EOF
</code></pre></div></blockquote> <p>The kustomization.yaml contains all the resources for deploying a WordPress site and a MySQL database. You can apply the directory and verify MapR volume and all the services:</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl apply --kustomize ./
secret/mysql-pass-9tt65k5fgm created
service/wordpress-mysql created
service/wordpress created
deployment.apps/wordpress-mysql created
deployment.apps/wordpress created
persistentvolumeclaim/mysql-pv-claim created
persistentvolumeclaim/wp-pv-claim created
</code></pre></div></blockquote> <p>Confirm PVC is using MapR StorageClass.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl get pvc
NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE
mysql-pv-claim Bound mapr-pv-16f97a33-b8dd-488a-b6db-1d94a84286e2 20Gi RWO default 48s
wp-pv-claim Bound mapr-pv-896b3504-e9ba-4593-b9a0-88a9ece392b5 20Gi RWO default 48s

<span class="token operator">&gt;</span> kubectl get <span class="token function">pv</span>
NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE
mapr-pv-32850109-ef66-42db-9522-b563fbc01eae 10Gi RWO Delete Bound bdwebterm/p-kdss-977sb-0 default 41h
mapr-pv-a24b1733-39db-40d2-bdaf-0be7c22ed83b 10Gi RWO Delete Bound bdwebterm/p-kdss-nbwhn-0 default 31h
mapr-pv-dbf96aed-dafd-47b7-87d4-7d343f182d8b 20Gi RWO Delete Bound default/mysql-pv-claim default 69s
mapr-pv-e3c1db71-2865-425c-971e-c01466e9d295 20Gi RWO Delete Bound default/wp-pv-claim default 69s
mapr-pv-ed5f1be3-9be2-4470-83cf-67f9b31e9dbf 10Gi RWO Delete Bound bdwebterm/p-kdss-dl26j-0 default 32h
</code></pre></div></blockquote> <p>Label the WordPress service so that it will be exposed via HPE Container Platform Gateway. Note that this step is NOT necessary if the service was created in the namespace of a tenant that has &quot;Map Services To Gateway&quot; enabled.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl get services
NAME TYPE CLUSTER-IP EXTERNAL-IP PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span> AGE
kubernetes ClusterIP <span class="token number">10.96</span>.0.1 <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span> <span class="token number">443</span>/TCP 26h
wordpress NodePort <span class="token number">10.96</span>.98.248 <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span> <span class="token number">80</span>:30996/TCP 24s
wordpress-mysql ClusterIP None <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span> <span class="token number">3306</span>/TCP 24s

<span class="token operator">&gt;</span> kubectl label svc wordpress hpecp.hpe.com/hpecp-internal-gateway<span class="token operator">=</span>true
service/wordpress labeled

<span class="token operator">&gt;</span> kubectl describe <span class="token function">service</span> wordpress
Name: wordpress
Namespace: default
Labels: <span class="token assign-left variable">app</span><span class="token operator">=</span>wordpress
hpecp.hpe.com/hpecp-internal-gateway<span class="token operator">=</span>true
Annotations: hpecp-internal-gateway/80: mip-bd-vm38.mip.storage.hpecorp.net:10006
Selector: <span class="token assign-left variable">app</span><span class="token operator">=</span>wordpress,tier<span class="token operator">=</span>frontend
Type: NodePort
IP: <span class="token number">10.96</span>.98.248
Port: <span class="token operator">&lt;</span>unset<span class="token operator">&gt;</span> <span class="token number">80</span>/TCP
TargetPort: <span class="token number">80</span>/TCP
NodePort: <span class="token operator">&lt;</span>unset<span class="token operator">&gt;</span> <span class="token number">30996</span>/TCP
Endpoints: <span class="token number">10.244</span>.2.11:80
Session Affinity: None
External Traffic Policy: Cluster
Events:
Type Reason Age From Message
---- ------ ---- ---- -------
Normal Service 26s kubedirector Created HPECP K8S <span class="token function">service</span>
</code></pre></div></blockquote> <p>Copy the IP address and Port number to your browser. You should see set up page similar to the following screenshot. Figure 33 depicts the WordPress welcome page.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure36.da3b1935.png" alt="WordPress welcome page "></p> <p><strong>Figure</strong> <strong>36.</strong> WordPress welcome page</p> <p>Destroy the application deployments (Example: pods) and restart the deployments. Validate the WordPress application information.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl delete deployment wordpress
deployment.extensions <span class="token string">&quot;wordpress&quot;</span> deleted

<span class="token operator">&gt;</span> kubectl delete deployment wordpress-mysql
deployment.extensions <span class="token string">&quot;wordpress-mysql&quot;</span> deleted

<span class="token operator">&gt;</span> kubectl get pods
No resources found.

<span class="token operator">&gt;</span> kubectl get deployments
No resources found.
</code></pre></div></blockquote> <p>Reapply the same deployment and reconnect to persistent storage.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl apply -k ./
secret/mysql-pass-9tt65k5fgm unchanged
service/wordpress-mysql unchanged
service/wordpress unchanged
deployment.apps/wordpress-mysql created
deployment.apps/wordpress created
persistentvolumeclaim/mysql-pv-claim unchanged
persistentvolumeclaim/wp-pv-claim unchanged

<span class="token operator">&gt;</span> kubectl get pods
NAME READY STATUS RESTARTS AGE
wordpress-594759d7f6-jdnvp <span class="token number">1</span>/1 Running <span class="token number">0</span> 27s
wordpress-mysql-847b7b996d-dwf6s <span class="token number">1</span>/1 Running <span class="token number">0</span> 28s

<span class="token operator">&gt;</span> kubectl describe <span class="token function">service</span> wordpress
Name: wordpress
Namespace: default
Labels: <span class="token assign-left variable">app</span><span class="token operator">=</span>wordpress
Hpecp.hpe.com/hpecp-internal-gateway<span class="token operator">=</span>true
Annotations: hpecp-internal-gateway/80: mip-bd-vm38.mip.storage.hpecorp.net:10006
Selector: <span class="token assign-left variable">app</span><span class="token operator">=</span>wordpress,tier<span class="token operator">=</span>frontend
Type: NodePort
IP: <span class="token number">10.96</span>.35.129
Port: <span class="token operator">&lt;</span>unset<span class="token operator">&gt;</span> <span class="token number">80</span>/TCP
TargetPort: <span class="token number">80</span>/TCP
NodePort: <span class="token operator">&lt;</span>unset<span class="token operator">&gt;</span> <span class="token number">31589</span>/TCP
Endpoints: <span class="token number">10.244</span>.1.18:80
Session Affinity: None
External Traffic Policy: Cluster
Events:
Type Reason Age From Message
---- ------ ---- ---- -------
Normal Service 12m kubedirector Created HPECP K8S <span class="token function">service</span>
</code></pre></div></blockquote> <p>WordPress service is restored.</p> <p>Figure 34 depicts the restoration of WordPress service.</p> <p><img src="/hpe-solutions-hpecp/5.0/assets/img/figure37.7760f9bc.png" alt="WordPress restoration service"></p> <p><strong>Figure</strong> <strong>37.</strong> WordPress restoration service</p> <h3 id="cleanup"><a href="#cleanup" class="header-anchor">#</a> Cleanup</h3> <p>To free up all the resources (including persistent storage), you will need to delete the whole deployment.</p> <blockquote><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> kubectl delete -k ./
secret <span class="token string">&quot;mysql-pass-9tt65k5fgm&quot;</span> deleted
<span class="token function">service</span> <span class="token string">&quot;wordpress-mysql&quot;</span> deleted
<span class="token function">service</span> <span class="token string">&quot;wordpress&quot;</span> deleted
deployment.apps <span class="token string">&quot;wordpress-mysql&quot;</span> deleted
deployment.apps <span class="token string">&quot;wordpress&quot;</span> deleted
persistentvolumeclaim <span class="token string">&quot;mysql-pv-claim&quot;</span> deleted
persistentvolumeclaim <span class="token string">&quot;wp-pv-claim&quot;</span> deleted
</code></pre></div></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-hpecp/5.0/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor/Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor.html" class="prev">
        Securing HPE Ezmeral Container Platform using Sysdig Secure and Sysdig Monitor
      </a></span> <span class="next"><a href="/hpe-solutions-hpecp/5.0/HPE CSI driver installation/HPE CSI driver installation.html">
        HPE CSI driver installation
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-hpecp/5.0/assets/js/app.9e57fa5b.js" defer></script><script src="/hpe-solutions-hpecp/5.0/assets/js/2.ca577d1f.js" defer></script><script src="/hpe-solutions-hpecp/5.0/assets/js/5.b9f3fa98.js" defer></script>
  </body>
</html>
